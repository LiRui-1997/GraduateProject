{"ast":null,"code":"import { FILTER_ACTION_APPEND, FILTER_ACTION_UPDATE, FilterTypes } from 'types/Filters';\n\nvar byWorkload = function byWorkload(workloads) {\n  return {\n    id: 'workload',\n    title: 'Workload',\n    placeholder: 'Filter by Workload',\n    filterType: FilterTypes.typeAhead,\n    action: FILTER_ACTION_APPEND,\n    filterValues: workloads,\n    run: function run(item, filters) {\n      return filters.filters.some(function (f) {\n        return f.value === item.workload;\n      });\n    }\n  };\n};\n\nvar byApp = function byApp(apps) {\n  return {\n    id: 'app',\n    title: 'App',\n    placeholder: 'Filter by App',\n    filterType: FilterTypes.typeAhead,\n    action: FILTER_ACTION_APPEND,\n    filterValues: apps,\n    run: function run(item, filters) {\n      return filters.filters.some(function (f) {\n        return f.value === item.app;\n      });\n    }\n  };\n};\n\nvar byComponent = function byComponent(components) {\n  return {\n    id: 'type',\n    title: 'Component',\n    placeholder: 'Filter by Span Component',\n    filterType: FilterTypes.typeAhead,\n    action: FILTER_ACTION_APPEND,\n    filterValues: components,\n    run: function run(item, filters) {\n      return filters.filters.some(function (f) {\n        return f.value === item.component;\n      });\n    }\n  };\n};\n\nvar byOperation = function byOperation(ops) {\n  return {\n    id: 'operation',\n    title: 'Operation',\n    placeholder: 'Filter by Operation Name',\n    filterType: FilterTypes.typeAhead,\n    action: FILTER_ACTION_APPEND,\n    filterValues: ops,\n    run: function run(item, filters) {\n      return filters.filters.some(function (f) {\n        return f.value === item.operationName;\n      });\n    }\n  };\n};\n\nvar byError = {\n  id: 'error',\n  title: 'Error',\n  placeholder: 'Filter by Error',\n  filterType: FilterTypes.select,\n  action: FILTER_ACTION_UPDATE,\n  filterValues: [{\n    id: 'yes',\n    title: 'With errors'\n  }, {\n    id: 'no',\n    title: 'Without errors'\n  }],\n  run: function run(item, filters) {\n    return filters.filters.some(function (f) {\n      return f.value === (item.info.hasError ? 'With errors' : 'Without errors');\n    });\n  }\n};\nexport var spanFilters = function spanFilters(spans) {\n  var workloads = new Set();\n  var apps = new Set();\n  var components = new Set();\n  var operations = new Set();\n  spans.forEach(function (s) {\n    workloads.add(s.workload || 'unknown');\n    apps.add(s.app);\n    components.add(s.component);\n    operations.add(s.operationName);\n  });\n  return [byWorkload(Array.from(workloads).map(function (w) {\n    return {\n      id: w,\n      title: w\n    };\n  })), byApp(Array.from(apps).map(function (w) {\n    return {\n      id: w,\n      title: w\n    };\n  })), byComponent(Array.from(components).map(function (w) {\n    return {\n      id: w,\n      title: w\n    };\n  })), byOperation(Array.from(operations).map(function (w) {\n    return {\n      id: w,\n      title: w\n    };\n  })), byError];\n};","map":{"version":3,"sources":["/root/GraduateProject/src/components/JaegerIntegration/JaegerResults/Filters.ts"],"names":["FILTER_ACTION_APPEND","FILTER_ACTION_UPDATE","FilterTypes","byWorkload","workloads","id","title","placeholder","filterType","typeAhead","action","filterValues","run","item","filters","some","f","value","workload","byApp","apps","app","byComponent","components","component","byOperation","ops","operationName","byError","select","info","hasError","spanFilters","spans","Set","operations","forEach","s","add","Array","from","map","w"],"mappings":"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","sourcesContent":["import { FILTER_ACTION_APPEND, FILTER_ACTION_UPDATE, FilterTypes, FilterValue, RunnableFilter } from 'types/Filters';\nimport { RichSpanData } from 'types/JaegerInfo';\n\nconst byWorkload = (workloads: FilterValue[]): RunnableFilter<RichSpanData> => {\n  return {\n    id: 'workload',\n    title: 'Workload',\n    placeholder: 'Filter by Workload',\n    filterType: FilterTypes.typeAhead,\n    action: FILTER_ACTION_APPEND,\n    filterValues: workloads,\n    run: (item, filters) => filters.filters.some(f => f.value === item.workload)\n  };\n};\n\nconst byApp = (apps: FilterValue[]): RunnableFilter<RichSpanData> => {\n  return {\n    id: 'app',\n    title: 'App',\n    placeholder: 'Filter by App',\n    filterType: FilterTypes.typeAhead,\n    action: FILTER_ACTION_APPEND,\n    filterValues: apps,\n    run: (item, filters) => filters.filters.some(f => f.value === item.app)\n  };\n};\n\nconst byComponent = (components: FilterValue[]): RunnableFilter<RichSpanData> => {\n  return {\n    id: 'type',\n    title: 'Component',\n    placeholder: 'Filter by Span Component',\n    filterType: FilterTypes.typeAhead,\n    action: FILTER_ACTION_APPEND,\n    filterValues: components,\n    run: (item, filters) => filters.filters.some(f => f.value === item.component)\n  };\n};\n\nconst byOperation = (ops: FilterValue[]): RunnableFilter<RichSpanData> => {\n  return {\n    id: 'operation',\n    title: 'Operation',\n    placeholder: 'Filter by Operation Name',\n    filterType: FilterTypes.typeAhead,\n    action: FILTER_ACTION_APPEND,\n    filterValues: ops,\n    run: (item, filters) => filters.filters.some(f => f.value === item.operationName)\n  };\n};\n\nconst byError: RunnableFilter<RichSpanData> = {\n  id: 'error',\n  title: 'Error',\n  placeholder: 'Filter by Error',\n  filterType: FilterTypes.select,\n  action: FILTER_ACTION_UPDATE,\n  filterValues: [\n    { id: 'yes', title: 'With errors' },\n    { id: 'no', title: 'Without errors' }\n  ],\n  run: (item, filters) => filters.filters.some(f => f.value === (item.info.hasError ? 'With errors' : 'Without errors'))\n};\n\nexport const spanFilters = (spans: RichSpanData[]): RunnableFilter<RichSpanData>[] => {\n  const workloads = new Set<string>();\n  const apps = new Set<string>();\n  const components = new Set<string>();\n  const operations = new Set<string>();\n  spans.forEach(s => {\n    workloads.add(s.workload || 'unknown');\n    apps.add(s.app);\n    components.add(s.component);\n    operations.add(s.operationName);\n  });\n  return [\n    byWorkload(Array.from(workloads).map(w => ({ id: w, title: w }))),\n    byApp(Array.from(apps).map(w => ({ id: w, title: w }))),\n    byComponent(Array.from(components).map(w => ({ id: w, title: w }))),\n    byOperation(Array.from(operations).map(w => ({ id: w, title: w }))),\n    byError\n  ];\n};\n"]},"metadata":{},"sourceType":"module"}