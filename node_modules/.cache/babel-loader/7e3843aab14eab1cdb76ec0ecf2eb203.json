{"ast":null,"code":"import _objectSpread from\"/root/GraduateProject/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _ from'lodash';import{parseHealthConfig}from'./HealthConfig';export var humanDurations=function humanDurations(cfg,prefix,suffix){return _.mapValues(cfg.durations,function(v){return _.reject([prefix,v,suffix],_.isEmpty).join(' ');});};var toDurations=function toDurations(tupleArray){var obj={};tupleArray.forEach(function(tuple){obj[tuple[0]]=tuple[1];});return obj;};var durationsTuples=[[60,'1m'],[300,'5m'],[600,'10m'],[1800,'30m'],[3600,'1h'],[10800,'3h'],[21600,'6h'],[43200,'12h'],[86400,'1d'],[604800,'7d'],[2592000,'30d']];var computeValidDurations=function computeValidDurations(cfg){var filtered=durationsTuples;if(cfg.prometheus.storageTsdbRetention){// Make sure we'll keep at least one item\nif(cfg.prometheus.storageTsdbRetention<=durationsTuples[0][0]){filtered=[durationsTuples[0]];}else{filtered=durationsTuples.filter(function(d){return d[0]<=cfg.prometheus.storageTsdbRetention;});}}cfg.durations=toDurations(filtered);};// Set some reasonable defaults. Initial values should be valid for fields\n// than may not be providedby/set on the server.\nvar defaultServerConfig={clusters:{},durations:{},healthConfig:{rate:[]},deployment:{viewOnlyMode:false},installationTag:'Kiali Console',istioAnnotations:{istioInjectionAnnotation:'sidecar.istio.io/inject'},istioCanaryRevision:{current:'',upgrade:''},istioIdentityDomain:'svc.cluster.local',istioNamespace:'istio-system',istioLabels:{appLabelName:'app',injectionLabelName:'istio-injection',injectionLabelRev:'istio.io/rev',versionLabelName:'version'},kialiFeatureFlags:{certificatesInformationIndicators:{enabled:true},istioInjectionAction:true,istioUpgradeAction:false},prometheus:{globalScrapeInterval:15,storageTsdbRetention:21600}};// Overwritten with real server config on user login. Also used for tests.\nvar serverConfig=defaultServerConfig;computeValidDurations(serverConfig);export{serverConfig};export var toValidDuration=function toValidDuration(duration){// Check if valid\nif(serverConfig.durations[duration]){return duration;}// Get closest duration\nfor(var i=durationsTuples.length-1;i>=0;i--){if(duration>durationsTuples[i][0]){return durationsTuples[i][0];}}return durationsTuples[0][0];};export var setServerConfig=function setServerConfig(cfg){serverConfig=_objectSpread(_objectSpread({},defaultServerConfig),cfg);serverConfig.healthConfig=cfg.healthConfig?parseHealthConfig(cfg.healthConfig):serverConfig.healthConfig;computeValidDurations(serverConfig);};export var isIstioNamespace=function isIstioNamespace(namespace){if(namespace===serverConfig.istioNamespace){return true;}return false;};","map":null,"metadata":{},"sourceType":"module"}