{"ast":null,"code":"(function () {\n  \"use strict\";\n\n  var $$find = function $$find(arr, predicate) {\n    if (typeof predicate !== \"function\") {\n      throw new TypeError(\"predicate must be a function\");\n    }\n\n    var length = arr.length >>> 0;\n    var thisArg = arguments[1];\n    var value;\n\n    for (var i = 0; i < length; i++) {\n      value = arr[i];\n\n      if (predicate.call(thisArg, value, i, arr)) {\n        return value;\n      }\n    }\n\n    return undefined;\n  };\n\n  var NodeHtmlEventType;\n\n  (function (NodeHtmlEventType) {\n    NodeHtmlEventType[\"CREATE_OR_UPDATE\"] = \"nodehtml-create-or-update\";\n    NodeHtmlEventType[\"DELETE\"] = \"nodehtml-delete\";\n  })(NodeHtmlEventType || (NodeHtmlEventType = {}));\n\n  var LabelElement = function () {\n    function LabelElement(_a, params) {\n      var node = _a.node,\n          _b = _a.position,\n          position = _b === void 0 ? null : _b,\n          _c = _a.data,\n          data = _c === void 0 ? null : _c;\n      this.updateParams(params);\n      this._node = node;\n      this.initStyles(params.cssClass);\n\n      if (data) {\n        this.updateData(data);\n      }\n\n      if (position) {\n        this.updatePosition(position);\n      }\n    }\n\n    LabelElement.prototype.updateParams = function (_a) {\n      var _b = _a.tpl,\n          tpl = _b === void 0 ? function () {\n        return \"\";\n      } : _b,\n          _c = _a.cssClass,\n          cssClass = _c === void 0 ? null : _c,\n          _d = _a.halign,\n          halign = _d === void 0 ? \"center\" : _d,\n          _e = _a.valign,\n          valign = _e === void 0 ? \"center\" : _e,\n          _f = _a.halignBox,\n          halignBox = _f === void 0 ? \"center\" : _f,\n          _g = _a.valignBox,\n          valignBox = _g === void 0 ? \"center\" : _g;\n      var _align = {\n        \"top\": -.5,\n        \"left\": -.5,\n        \"center\": 0,\n        \"right\": .5,\n        \"bottom\": .5\n      };\n      this._align = [_align[halign], _align[valign], 100 * (_align[halignBox] - 0.5), 100 * (_align[valignBox] - 0.5)];\n      this.tpl = tpl;\n    };\n\n    LabelElement.prototype.updateData = function (data) {\n      try {\n        this._node.innerHTML = this.tpl(data);\n      } catch (err) {\n        console.error(err);\n      }\n    };\n\n    LabelElement.prototype.getNode = function () {\n      return this._node;\n    };\n\n    LabelElement.prototype.updatePosition = function (pos) {\n      this._renderPosition(pos);\n    };\n\n    LabelElement.prototype.initStyles = function (cssClass) {\n      var stl = this._node.style;\n      stl.position = \"absolute\";\n\n      if (cssClass && cssClass.length) {\n        this._node.classList.add(cssClass);\n      }\n    };\n\n    LabelElement.prototype._renderPosition = function (position) {\n      var prev = this._position;\n      var x = position.x + this._align[0] * position.w;\n      var y = position.y + this._align[1] * position.h;\n\n      if (!prev || prev[0] !== x || prev[1] !== y) {\n        this._position = [x, y];\n        var valRel = \"translate(\" + this._align[2] + \"%,\" + this._align[3] + \"%) \";\n        var valAbs = \"translate(\" + x.toFixed(2) + \"px,\" + y.toFixed(2) + \"px) \";\n        var val = valRel + valAbs;\n        var stl = this._node.style;\n        stl.webkitTransform = val;\n        stl.msTransform = val;\n        stl.transform = val;\n      }\n    };\n\n    return LabelElement;\n  }();\n\n  var LabelContainer = function () {\n    function LabelContainer(node) {\n      this._node = node;\n      this._elements = {};\n    }\n\n    LabelContainer.prototype.addOrUpdateElem = function (id, param, payload) {\n      if (payload === void 0) {\n        payload = {};\n      }\n\n      var cur = this._elements[id];\n\n      if (cur) {\n        cur.updateParams(param);\n        cur.updateData(payload.data);\n        cur.updatePosition(payload.position);\n        return {\n          label: cur,\n          isNew: false\n        };\n      } else {\n        var nodeElem = document.createElement(\"div\");\n\n        this._node.appendChild(nodeElem);\n\n        this._elements[id] = new LabelElement({\n          node: nodeElem,\n          data: payload.data,\n          position: payload.position\n        }, param);\n        return {\n          label: this._elements[id],\n          isNew: true\n        };\n      }\n    };\n\n    LabelContainer.prototype.removeElemById = function (id) {\n      if (this._elements[id]) {\n        this._node.removeChild(this._elements[id].getNode());\n\n        delete this._elements[id];\n        return true;\n      }\n\n      return false;\n    };\n\n    LabelContainer.prototype.updateElemPosition = function (id, position) {\n      var ele = this._elements[id];\n\n      if (ele) {\n        ele.updatePosition(position);\n      }\n    };\n\n    LabelContainer.prototype.updatePanZoom = function (_a) {\n      var pan = _a.pan,\n          zoom = _a.zoom;\n      var val = \"translate(\" + pan.x + \"px,\" + pan.y + \"px) scale(\" + zoom + \")\";\n      var stl = this._node.style;\n      var origin = \"top left\";\n      stl.webkitTransform = val;\n      stl.msTransform = val;\n      stl.transform = val;\n      stl.webkitTransformOrigin = origin;\n      stl.msTransformOrigin = origin;\n      stl.transformOrigin = origin;\n    };\n\n    return LabelContainer;\n  }();\n\n  var CytoscapeNodeHtmlLabel = function () {\n    function CytoscapeNodeHtmlLabel(cy, params) {\n      var _this = this;\n\n      this.addCyHandler = function (ev) {\n        var target = ev.target;\n        var param = $$find(_this.params.slice().reverse(), function (x) {\n          return target.is(x.query);\n        });\n\n        if (param) {\n          var nodePosition = _this.getNodePosition(target);\n\n          var _a = _this.labelContainer.addOrUpdateElem(target.id(), param, {\n            position: nodePosition,\n            data: target.data()\n          }),\n              label = _a.label,\n              isNew = _a.isNew;\n\n          _this.triggerCreateOrUpdateEvent(target, label, nodePosition, isNew);\n        }\n      };\n\n      this.layoutstopHandler = function (_a) {\n        var cy = _a.cy;\n\n        _this.params.forEach(function (x) {\n          cy.elements(x.query).forEach(function (d) {\n            if (d.isNode()) {\n              _this.labelContainer.updateElemPosition(d.id(), _this.getNodePosition(d));\n            }\n          });\n        });\n      };\n\n      this.removeCyHandler = function (ev) {\n        _this.labelContainer.removeElemById(ev.target.id());\n\n        _this.triggerDeleteEvent(ev.target);\n      };\n\n      this.moveCyHandler = function (ev) {\n        _this.labelContainer.updateElemPosition(ev.target.id(), _this.getNodePosition(ev.target));\n      };\n\n      this.updateDataOrStyleCyHandler = function (ev) {\n        if (ev.cy.destroyed()) {\n          return;\n        }\n\n        _this.updateNode(ev.target);\n      };\n\n      this.createNodesCyHandler = function (_a) {\n        var cy = _a.cy;\n\n        _this.params.forEach(function (x) {\n          cy.elements(x.query).forEach(function (d) {\n            if (d.isNode()) {\n              var nodePosition = _this.getNodePosition(d);\n\n              var _a = _this.labelContainer.addOrUpdateElem(d.id(), x, {\n                position: nodePosition,\n                data: d.data()\n              }),\n                  label = _a.label,\n                  isNew = _a.isNew;\n\n              _this.triggerCreateOrUpdateEvent(d, label, nodePosition, isNew);\n            }\n          });\n        });\n      };\n\n      this.wrapCyHandler = function (_a) {\n        var cy = _a.cy;\n\n        _this.labelContainer.updatePanZoom({\n          pan: cy.pan(),\n          zoom: cy.zoom()\n        });\n      };\n\n      this.params = params;\n      this.labelContainer = this.createLabelContainer(cy);\n      this.attachEvents(cy);\n    }\n\n    CytoscapeNodeHtmlLabel.prototype.updateNodeLabel = function (target) {\n      var _this = this;\n\n      target.each(function (ele) {\n        _this.updateNode(ele);\n      });\n    };\n\n    CytoscapeNodeHtmlLabel.prototype.attachEvents = function (cy) {\n      var _this = this;\n\n      cy.one(\"render\", function (e) {\n        _this.createNodesCyHandler(e);\n\n        _this.wrapCyHandler(e);\n      });\n      cy.on(\"add\", this.addCyHandler);\n      cy.on(\"layoutstop\", this.layoutstopHandler);\n      cy.on(\"remove\", this.removeCyHandler);\n      cy.on(\"data\", this.updateDataOrStyleCyHandler);\n      cy.on(\"style\", this.updateDataOrStyleCyHandler);\n      cy.on(\"pan zoom\", this.wrapCyHandler);\n      cy.on(\"position bounds\", this.moveCyHandler);\n    };\n\n    CytoscapeNodeHtmlLabel.prototype.updateNode = function (node) {\n      var param = $$find(this.params.slice().reverse(), function (x) {\n        return node.is(x.query);\n      });\n\n      if (param) {\n        var nodePosition = this.getNodePosition(node);\n\n        var _a = this.labelContainer.addOrUpdateElem(node.id(), param, {\n          position: nodePosition,\n          data: node.data()\n        }),\n            label = _a.label,\n            isNew = _a.isNew;\n\n        this.triggerCreateOrUpdateEvent(node, label, nodePosition, isNew);\n      } else {\n        this.labelContainer.removeElemById(node.id());\n        this.triggerDeleteEvent(node);\n      }\n    };\n\n    CytoscapeNodeHtmlLabel.prototype.createLabelContainer = function (cy) {\n      var _cyContainer = cy.container();\n\n      var _titlesContainer = document.createElement(\"div\");\n\n      var _cyCanvas = _cyContainer.querySelector(\"canvas\");\n\n      var cur = _cyContainer.querySelector(\"[class^='cy-node-html']\");\n\n      if (cur) {\n        _cyCanvas.parentNode.removeChild(cur);\n      }\n\n      var stl = _titlesContainer.style;\n      stl.position = \"absolute\";\n      stl[\"z-index\"] = 10;\n      stl.width = \"500px\";\n      stl[\"pointer-events\"] = \"all\";\n      stl.cursor = \"default\";\n      stl.margin = \"0px\";\n      stl.padding = \"0px\";\n      stl.border = \"0px\";\n      stl.outline = \"0px\";\n      stl.outline = \"0px\";\n\n      _cyCanvas.parentNode.appendChild(_titlesContainer);\n\n      return new LabelContainer(_titlesContainer);\n    };\n\n    CytoscapeNodeHtmlLabel.prototype.triggerCreateOrUpdateEvent = function (cytoscapeNode, label, position, isNew) {\n      var eventData = {\n        label: label,\n        position: position,\n        isNew: isNew\n      };\n      cytoscapeNode.trigger(NodeHtmlEventType.CREATE_OR_UPDATE, eventData);\n    };\n\n    CytoscapeNodeHtmlLabel.prototype.triggerDeleteEvent = function (cytoscapeNode) {\n      cytoscapeNode.trigger(NodeHtmlEventType.DELETE);\n    };\n\n    CytoscapeNodeHtmlLabel.prototype.getNodePosition = function (node) {\n      return {\n        w: node.width(),\n        h: node.height(),\n        x: node.position(\"x\"),\n        y: node.position(\"y\")\n      };\n    };\n\n    return CytoscapeNodeHtmlLabel;\n  }();\n\n  function cyNodeHtmlLabel(_cy, params) {\n    var SCRATCHPAD_NAMESPACE_INSTANCE = \"cytoscape-node-html-label.instance\";\n\n    var instance = _cy.scratch(SCRATCHPAD_NAMESPACE_INSTANCE);\n\n    if (instance) {\n      return instance;\n    }\n\n    var _params = !params || typeof params !== \"object\" ? [] : params;\n\n    instance = new CytoscapeNodeHtmlLabel(_cy, _params);\n\n    _cy.scratch(SCRATCHPAD_NAMESPACE_INSTANCE, instance);\n\n    return instance;\n  }\n\n  var register = function register(cy) {\n    if (!cy) {\n      return;\n    }\n\n    cy(\"core\", \"nodeHtmlLabel\", function (optArr) {\n      return cyNodeHtmlLabel(this, optArr);\n    });\n  };\n\n  if (typeof module !== \"undefined\" && module.exports) {\n    module.exports = function (cy) {\n      register(cy);\n    };\n  } else {\n    if (typeof define !== \"undefined\" && define.amd) {\n      define(\"cytoscape-nodeHtmlLabel\", function () {\n        return register;\n      });\n    }\n  }\n\n  if (typeof cytoscape !== \"undefined\") {\n    register(cytoscape);\n  }\n})();","map":{"version":3,"sources":["../src/cytoscape-node-html-label.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["(function () {\n    \"use strict\";\n    var $$find = function (arr, predicate) {\n        if (typeof predicate !== \"function\") {\n            throw new TypeError(\"predicate must be a function\");\n        }\n        var length = arr.length >>> 0;\n        var thisArg = arguments[1];\n        var value;\n        for (var i = 0; i < length; i++) {\n            value = arr[i];\n            if (predicate.call(thisArg, value, i, arr)) {\n                return value;\n            }\n        }\n        return undefined;\n    };\n    var NodeHtmlEventType;\n    (function (NodeHtmlEventType) {\n        NodeHtmlEventType[\"CREATE_OR_UPDATE\"] = \"nodehtml-create-or-update\";\n        NodeHtmlEventType[\"DELETE\"] = \"nodehtml-delete\";\n    })(NodeHtmlEventType || (NodeHtmlEventType = {}));\n    var LabelElement = (function () {\n        function LabelElement(_a, params) {\n            var node = _a.node, _b = _a.position, position = _b === void 0 ? null : _b, _c = _a.data, data = _c === void 0 ? null : _c;\n            this.updateParams(params);\n            this._node = node;\n            this.initStyles(params.cssClass);\n            if (data) {\n                this.updateData(data);\n            }\n            if (position) {\n                this.updatePosition(position);\n            }\n        }\n        LabelElement.prototype.updateParams = function (_a) {\n            var _b = _a.tpl, tpl = _b === void 0 ? function () { return \"\"; } : _b, _c = _a.cssClass, cssClass = _c === void 0 ? null : _c, _d = _a.halign, halign = _d === void 0 ? \"center\" : _d, _e = _a.valign, valign = _e === void 0 ? \"center\" : _e, _f = _a.halignBox, halignBox = _f === void 0 ? \"center\" : _f, _g = _a.valignBox, valignBox = _g === void 0 ? \"center\" : _g;\n            var _align = {\n                \"top\": -.5,\n                \"left\": -.5,\n                \"center\": 0,\n                \"right\": .5,\n                \"bottom\": .5\n            };\n            this._align = [\n                _align[halign],\n                _align[valign],\n                100 * (_align[halignBox] - 0.5),\n                100 * (_align[valignBox] - 0.5)\n            ];\n            this.tpl = tpl;\n        };\n        LabelElement.prototype.updateData = function (data) {\n            try {\n                this._node.innerHTML = this.tpl(data);\n            }\n            catch (err) {\n                console.error(err);\n            }\n        };\n        LabelElement.prototype.getNode = function () {\n            return this._node;\n        };\n        LabelElement.prototype.updatePosition = function (pos) {\n            this._renderPosition(pos);\n        };\n        LabelElement.prototype.initStyles = function (cssClass) {\n            var stl = this._node.style;\n            stl.position = \"absolute\";\n            if (cssClass && cssClass.length) {\n                this._node.classList.add(cssClass);\n            }\n        };\n        LabelElement.prototype._renderPosition = function (position) {\n            var prev = this._position;\n            var x = position.x + this._align[0] * position.w;\n            var y = position.y + this._align[1] * position.h;\n            if (!prev || prev[0] !== x || prev[1] !== y) {\n                this._position = [x, y];\n                var valRel = \"translate(\" + this._align[2] + \"%,\" + this._align[3] + \"%) \";\n                var valAbs = \"translate(\" + x.toFixed(2) + \"px,\" + y.toFixed(2) + \"px) \";\n                var val = valRel + valAbs;\n                var stl = this._node.style;\n                stl.webkitTransform = val;\n                stl.msTransform = val;\n                stl.transform = val;\n            }\n        };\n        return LabelElement;\n    }());\n    var LabelContainer = (function () {\n        function LabelContainer(node) {\n            this._node = node;\n            this._elements = {};\n        }\n        LabelContainer.prototype.addOrUpdateElem = function (id, param, payload) {\n            if (payload === void 0) { payload = {}; }\n            var cur = this._elements[id];\n            if (cur) {\n                cur.updateParams(param);\n                cur.updateData(payload.data);\n                cur.updatePosition(payload.position);\n                return {\n                    label: cur,\n                    isNew: false\n                };\n            }\n            else {\n                var nodeElem = document.createElement(\"div\");\n                this._node.appendChild(nodeElem);\n                this._elements[id] = new LabelElement({\n                    node: nodeElem,\n                    data: payload.data,\n                    position: payload.position\n                }, param);\n                return {\n                    label: this._elements[id],\n                    isNew: true\n                };\n            }\n        };\n        LabelContainer.prototype.removeElemById = function (id) {\n            if (this._elements[id]) {\n                this._node.removeChild(this._elements[id].getNode());\n                delete this._elements[id];\n                return true;\n            }\n            return false;\n        };\n        LabelContainer.prototype.updateElemPosition = function (id, position) {\n            var ele = this._elements[id];\n            if (ele) {\n                ele.updatePosition(position);\n            }\n        };\n        LabelContainer.prototype.updatePanZoom = function (_a) {\n            var pan = _a.pan, zoom = _a.zoom;\n            var val = \"translate(\" + pan.x + \"px,\" + pan.y + \"px) scale(\" + zoom + \")\";\n            var stl = this._node.style;\n            var origin = \"top left\";\n            stl.webkitTransform = val;\n            stl.msTransform = val;\n            stl.transform = val;\n            stl.webkitTransformOrigin = origin;\n            stl.msTransformOrigin = origin;\n            stl.transformOrigin = origin;\n        };\n        return LabelContainer;\n    }());\n    var CytoscapeNodeHtmlLabel = (function () {\n        function CytoscapeNodeHtmlLabel(cy, params) {\n            var _this = this;\n            this.addCyHandler = function (ev) {\n                var target = ev.target;\n                var param = $$find(_this.params.slice().reverse(), function (x) { return target.is(x.query); });\n                if (param) {\n                    var nodePosition = _this.getNodePosition(target);\n                    var _a = _this.labelContainer.addOrUpdateElem(target.id(), param, {\n                        position: nodePosition,\n                        data: target.data()\n                    }), label = _a.label, isNew = _a.isNew;\n                    _this.triggerCreateOrUpdateEvent(target, label, nodePosition, isNew);\n                }\n            };\n            this.layoutstopHandler = function (_a) {\n                var cy = _a.cy;\n                _this.params.forEach(function (x) {\n                    cy.elements(x.query).forEach(function (d) {\n                        if (d.isNode()) {\n                            _this.labelContainer.updateElemPosition(d.id(), _this.getNodePosition(d));\n                        }\n                    });\n                });\n            };\n            this.removeCyHandler = function (ev) {\n                _this.labelContainer.removeElemById(ev.target.id());\n                _this.triggerDeleteEvent(ev.target);\n            };\n            this.moveCyHandler = function (ev) {\n                _this.labelContainer.updateElemPosition(ev.target.id(), _this.getNodePosition(ev.target));\n            };\n            this.updateDataOrStyleCyHandler = function (ev) {\n                if (ev.cy.destroyed()) {\n                    return;\n                }\n                _this.updateNode(ev.target);\n            };\n            this.createNodesCyHandler = function (_a) {\n                var cy = _a.cy;\n                _this.params.forEach(function (x) {\n                    cy.elements(x.query).forEach(function (d) {\n                        if (d.isNode()) {\n                            var nodePosition = _this.getNodePosition(d);\n                            var _a = _this.labelContainer.addOrUpdateElem(d.id(), x, {\n                                position: nodePosition,\n                                data: d.data()\n                            }), label = _a.label, isNew = _a.isNew;\n                            _this.triggerCreateOrUpdateEvent(d, label, nodePosition, isNew);\n                        }\n                    });\n                });\n            };\n            this.wrapCyHandler = function (_a) {\n                var cy = _a.cy;\n                _this.labelContainer.updatePanZoom({\n                    pan: cy.pan(),\n                    zoom: cy.zoom()\n                });\n            };\n            this.params = params;\n            this.labelContainer = this.createLabelContainer(cy);\n            this.attachEvents(cy);\n        }\n        CytoscapeNodeHtmlLabel.prototype.updateNodeLabel = function (target) {\n            var _this = this;\n            target.each(function (ele) {\n                _this.updateNode(ele);\n            });\n        };\n        CytoscapeNodeHtmlLabel.prototype.attachEvents = function (cy) {\n            var _this = this;\n            cy.one(\"render\", function (e) {\n                _this.createNodesCyHandler(e);\n                _this.wrapCyHandler(e);\n            });\n            cy.on(\"add\", this.addCyHandler);\n            cy.on(\"layoutstop\", this.layoutstopHandler);\n            cy.on(\"remove\", this.removeCyHandler);\n            cy.on(\"data\", this.updateDataOrStyleCyHandler);\n            cy.on(\"style\", this.updateDataOrStyleCyHandler);\n            cy.on(\"pan zoom\", this.wrapCyHandler);\n            cy.on(\"position bounds\", this.moveCyHandler);\n        };\n        CytoscapeNodeHtmlLabel.prototype.updateNode = function (node) {\n            var param = $$find(this.params.slice().reverse(), function (x) { return node.is(x.query); });\n            if (param) {\n                var nodePosition = this.getNodePosition(node);\n                var _a = this.labelContainer.addOrUpdateElem(node.id(), param, {\n                    position: nodePosition,\n                    data: node.data()\n                }), label = _a.label, isNew = _a.isNew;\n                this.triggerCreateOrUpdateEvent(node, label, nodePosition, isNew);\n            }\n            else {\n                this.labelContainer.removeElemById(node.id());\n                this.triggerDeleteEvent(node);\n            }\n        };\n        CytoscapeNodeHtmlLabel.prototype.createLabelContainer = function (cy) {\n            var _cyContainer = cy.container();\n            var _titlesContainer = document.createElement(\"div\");\n            var _cyCanvas = _cyContainer.querySelector(\"canvas\");\n            var cur = _cyContainer.querySelector(\"[class^='cy-node-html']\");\n            if (cur) {\n                _cyCanvas.parentNode.removeChild(cur);\n            }\n            var stl = _titlesContainer.style;\n            stl.position = \"absolute\";\n            stl[\"z-index\"] = 10;\n            stl.width = \"500px\";\n            stl[\"pointer-events\"] = \"all\";\n            stl.cursor = \"default\";\n            stl.margin = \"0px\";\n            stl.padding = \"0px\";\n            stl.border = \"0px\";\n            stl.outline = \"0px\";\n            stl.outline = \"0px\";\n            _cyCanvas.parentNode.appendChild(_titlesContainer);\n            return new LabelContainer(_titlesContainer);\n        };\n        CytoscapeNodeHtmlLabel.prototype.triggerCreateOrUpdateEvent = function (cytoscapeNode, label, position, isNew) {\n            var eventData = {\n                label: label,\n                position: position,\n                isNew: isNew\n            };\n            cytoscapeNode.trigger(NodeHtmlEventType.CREATE_OR_UPDATE, eventData);\n        };\n        CytoscapeNodeHtmlLabel.prototype.triggerDeleteEvent = function (cytoscapeNode) {\n            cytoscapeNode.trigger(NodeHtmlEventType.DELETE);\n        };\n        CytoscapeNodeHtmlLabel.prototype.getNodePosition = function (node) {\n            return {\n                w: node.width(),\n                h: node.height(),\n                x: node.position(\"x\"),\n                y: node.position(\"y\")\n            };\n        };\n        return CytoscapeNodeHtmlLabel;\n    }());\n    function cyNodeHtmlLabel(_cy, params) {\n        var SCRATCHPAD_NAMESPACE_INSTANCE = \"cytoscape-node-html-label.instance\";\n        var instance = _cy.scratch(SCRATCHPAD_NAMESPACE_INSTANCE);\n        if (instance) {\n            return instance;\n        }\n        var _params = (!params || typeof params !== \"object\") ? [] : params;\n        instance = new CytoscapeNodeHtmlLabel(_cy, _params);\n        _cy.scratch(SCRATCHPAD_NAMESPACE_INSTANCE, instance);\n        return instance;\n    }\n    var register = function (cy) {\n        if (!cy) {\n            return;\n        }\n        cy(\"core\", \"nodeHtmlLabel\", function (optArr) {\n            return cyNodeHtmlLabel(this, optArr);\n        });\n    };\n    if (typeof module !== \"undefined\" && module.exports) {\n        module.exports = function (cy) {\n            register(cy);\n        };\n    }\n    else {\n        if (typeof define !== \"undefined\" && define.amd) {\n            define(\"cytoscape-nodeHtmlLabel\", function () {\n                return register;\n            });\n        }\n    }\n    if (typeof cytoscape !== \"undefined\") {\n        register(cytoscape);\n    }\n}());\n//# sourceMappingURL=cytoscape-node-html-label.js.map"]},"metadata":{},"sourceType":"script"}