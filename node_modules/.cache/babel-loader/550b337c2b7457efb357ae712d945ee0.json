{"ast":null,"code":"import _objectSpread from \"/root/kiali-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nimport _classCallCheck from \"/root/kiali-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/root/kiali-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/root/kiali-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/root/kiali-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"/root/kiali-ui/src/components/Charts/SparklineChart.tsx\";\nimport * as React from 'react';\nimport { Chart, ChartVoronoiContainer, ChartAxis, ChartScatter, ChartArea, ChartLabel } from '@patternfly/react-charts';\nimport { VictoryLegend } from 'victory';\nimport { CustomTooltip } from './CustomTooltip';\nimport { addLegendEvent } from 'utils/VictoryEvents';\nexport var INTERPOTALION_STRATEGY = 'monotoneX';\nexport var SparklineChart = /*#__PURE__*/function (_React$Component) {\n  _inherits(SparklineChart, _React$Component);\n\n  var _super = _createSuper(SparklineChart);\n\n  function SparklineChart(props) {\n    var _this;\n\n    _classCallCheck(this, SparklineChart);\n\n    _this = _super.call(this, props);\n    _this.containerRef = void 0;\n\n    _this.handleResize = function () {\n      if (_this.containerRef && _this.containerRef.current) {\n        _this.setState({\n          width: _this.containerRef.current.clientWidth\n        });\n      }\n    };\n\n    if (props.width === undefined) {\n      _this.containerRef = React.createRef();\n    }\n\n    _this.state = {\n      width: props.width || 1,\n      hiddenSeries: new Set()\n    };\n    return _this;\n  }\n\n  _createClass(SparklineChart, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      if (this.containerRef) {\n        setTimeout(function () {\n          _this2.handleResize();\n\n          window.addEventListener('resize', _this2.handleResize);\n        });\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      if (this.containerRef) {\n        window.removeEventListener('resize', this.handleResize);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (this.containerRef) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          ref: this.containerRef,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 66,\n            columnNumber: 14\n          }\n        }, this.renderChart());\n      }\n\n      return this.renderChart();\n    }\n  }, {\n    key: \"renderChart\",\n    value: function renderChart() {\n      var _this3 = this;\n\n      var legendHeight = 30;\n      var height = this.props.height || 300;\n\n      var padding = _objectSpread({\n        top: 0,\n        bottom: 0,\n        left: 0,\n        right: 0\n      }, this.props.padding);\n\n      var events = [];\n\n      if (this.props.showLegend) {\n        padding.bottom += legendHeight;\n        height += legendHeight;\n        this.props.series.forEach(function (_, idx) {\n          addLegendEvent(events, {\n            legendName: _this3.props.name + '-legend',\n            idx: idx,\n            serieID: _this3.props.name + '-area-' + idx,\n            onClick: function onClick() {\n              if (!_this3.state.hiddenSeries.delete(idx)) {\n                // Was not already hidden => add to set\n                _this3.state.hiddenSeries.add(idx);\n              }\n\n              _this3.setState({\n                hiddenSeries: new Set(_this3.state.hiddenSeries)\n              });\n\n              return null;\n            },\n            onMouseOver: function onMouseOver(props) {\n              return {\n                style: _objectSpread(_objectSpread({}, props.style), {}, {\n                  strokeWidth: 4,\n                  fillOpacity: 0.5\n                })\n              };\n            }\n          });\n        });\n      }\n\n      var container = /*#__PURE__*/React.createElement(ChartVoronoiContainer, {\n        labels: function labels(obj) {\n          return _this3.props.tooltipFormat ? _this3.props.tooltipFormat(obj.datum) : obj.datum.y;\n        },\n        labelComponent: /*#__PURE__*/React.createElement(CustomTooltip, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 25\n          }\n        }),\n        voronoiBlacklist: this.props.series.map(function (_, idx) {\n          return _this3.props.name + '-scatter-' + idx;\n        }),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102,\n          columnNumber: 7\n        }\n      });\n      var hiddenAxisStyle = {\n        axis: {\n          stroke: 'none'\n        },\n        ticks: {\n          stroke: 'none'\n        },\n        tickLabels: {\n          stroke: 'none',\n          fill: 'none'\n        }\n      };\n      return /*#__PURE__*/React.createElement(Chart, Object.assign({}, this.props, {\n        height: height,\n        width: this.state.width,\n        padding: padding,\n        events: events,\n        containerComponent: container // Hack: 1 pxl on Y domain padding to prevent harsh clipping (https://github.com/kiali/kiali/issues/2069)\n        ,\n        domainPadding: {\n          y: 1\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 7\n        }\n      }), /*#__PURE__*/React.createElement(ChartAxis, {\n        tickCount: 15,\n        style: hiddenAxisStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 9\n        }\n      }), this.props.showYAxis ? /*#__PURE__*/React.createElement(ChartAxis, {\n        label: \"ops\",\n        axisLabelComponent: /*#__PURE__*/React.createElement(ChartLabel, {\n          y: 0,\n          x: 15,\n          angle: 0,\n          renderInPortal: true,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 129,\n            columnNumber: 33\n          }\n        }),\n        tickCount: 2,\n        dependentAxis: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 11\n        }\n      }) : /*#__PURE__*/React.createElement(ChartAxis, {\n        dependentAxis: true,\n        style: hiddenAxisStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 11\n        }\n      }), this.props.series.map(function (serie, idx) {\n        if (_this3.state.hiddenSeries.has(idx)) {\n          return undefined;\n        }\n\n        return /*#__PURE__*/React.createElement(ChartScatter, {\n          name: _this3.props.name + '-scatter-' + idx,\n          key: _this3.props.name + '-scatter-' + idx,\n          data: serie.datapoints,\n          style: {\n            data: {\n              fill: serie.color\n            }\n          },\n          size: function size(_ref) {\n            var active = _ref.active;\n            return active ? 5 : 2;\n          },\n          __self: _this3,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 141,\n            columnNumber: 13\n          }\n        });\n      }), this.props.series.map(function (serie, idx) {\n        if (_this3.state.hiddenSeries.has(idx)) {\n          return undefined;\n        }\n\n        return /*#__PURE__*/React.createElement(ChartArea, {\n          name: _this3.props.name + '-area-' + idx,\n          key: _this3.props.name + '-area-' + idx,\n          data: serie.datapoints,\n          style: {\n            data: {\n              fill: serie.color,\n              fillOpacity: 0.2,\n              stroke: serie.color,\n              strokeWidth: 2\n            }\n          },\n          interpolation: INTERPOTALION_STRATEGY,\n          __self: _this3,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 13\n          }\n        });\n      }), this.props.showLegend && /*#__PURE__*/React.createElement(VictoryLegend, {\n        name: this.props.name + '-legend',\n        data: this.props.series.map(function (s, idx) {\n          if (_this3.state.hiddenSeries.has(idx)) {\n            return _objectSpread(_objectSpread({}, s.legendItem), {}, {\n              symbol: {\n                fill: '#72767b'\n              }\n            });\n          }\n\n          return s.legendItem;\n        }),\n        y: height - legendHeight,\n        height: legendHeight,\n        width: this.state.width,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 11\n        }\n      }));\n    }\n  }]);\n\n  return SparklineChart;\n}(React.Component);","map":{"version":3,"sources":["/root/kiali-ui/src/components/Charts/SparklineChart.tsx"],"names":["React","Chart","ChartVoronoiContainer","ChartAxis","ChartScatter","ChartArea","ChartLabel","VictoryLegend","CustomTooltip","addLegendEvent","INTERPOTALION_STRATEGY","SparklineChart","props","containerRef","handleResize","current","setState","width","clientWidth","undefined","createRef","state","hiddenSeries","Set","setTimeout","window","addEventListener","removeEventListener","renderChart","legendHeight","height","padding","top","bottom","left","right","events","showLegend","series","forEach","_","idx","legendName","name","serieID","onClick","delete","add","onMouseOver","style","strokeWidth","fillOpacity","container","obj","tooltipFormat","datum","y","map","hiddenAxisStyle","axis","stroke","ticks","tickLabels","fill","showYAxis","serie","has","datapoints","data","color","active","s","legendItem","symbol","Component"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport {\n  Chart,\n  ChartProps,\n  ChartVoronoiContainer,\n  ChartAxis,\n  ChartScatter,\n  ChartArea,\n  ChartLabel\n} from '@patternfly/react-charts';\nimport { VictoryLegend } from 'victory';\n\nimport { VCLines, VCDataPoint, RichDataPoint } from 'types/VictoryChartInfo';\nimport { CustomTooltip } from './CustomTooltip';\nimport { VCEvent, addLegendEvent } from 'utils/VictoryEvents';\n\ntype Props = ChartProps & {\n  name: string;\n  series: VCLines<RichDataPoint>;\n  showLegend?: boolean;\n  showYAxis?: boolean;\n  tooltipFormat?: (dp: VCDataPoint) => string;\n};\n\ntype State = {\n  width: number;\n  hiddenSeries: Set<number>;\n};\n\nexport const INTERPOTALION_STRATEGY = 'monotoneX';\n\nexport class SparklineChart extends React.Component<Props, State> {\n  containerRef?: React.RefObject<HTMLDivElement>;\n\n  constructor(props: Props) {\n    super(props);\n    if (props.width === undefined) {\n      this.containerRef = React.createRef<HTMLDivElement>();\n    }\n    this.state = { width: props.width || 1, hiddenSeries: new Set() };\n  }\n\n  private handleResize = () => {\n    if (this.containerRef && this.containerRef.current) {\n      this.setState({ width: this.containerRef.current.clientWidth });\n    }\n  };\n\n  componentDidMount() {\n    if (this.containerRef) {\n      setTimeout(() => {\n        this.handleResize();\n        window.addEventListener('resize', this.handleResize);\n      });\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.containerRef) {\n      window.removeEventListener('resize', this.handleResize);\n    }\n  }\n\n  render() {\n    if (this.containerRef) {\n      return <div ref={this.containerRef}>{this.renderChart()}</div>;\n    }\n    return this.renderChart();\n  }\n\n  private renderChart() {\n    const legendHeight = 30;\n    let height = this.props.height || 300;\n    const padding = { top: 0, bottom: 0, left: 0, right: 0, ...this.props.padding };\n    const events: VCEvent[] = [];\n    if (this.props.showLegend) {\n      padding.bottom += legendHeight;\n      height += legendHeight;\n      this.props.series.forEach((_, idx) => {\n        addLegendEvent(events, {\n          legendName: this.props.name + '-legend',\n          idx: idx,\n          serieID: this.props.name + '-area-' + idx,\n          onClick: () => {\n            if (!this.state.hiddenSeries.delete(idx)) {\n              // Was not already hidden => add to set\n              this.state.hiddenSeries.add(idx);\n            }\n            this.setState({ hiddenSeries: new Set(this.state.hiddenSeries) });\n            return null;\n          },\n          onMouseOver: props => {\n            return {\n              style: { ...props.style, strokeWidth: 4, fillOpacity: 0.5 }\n            };\n          }\n        });\n      });\n    }\n\n    const container = (\n      <ChartVoronoiContainer\n        labels={obj => (this.props.tooltipFormat ? this.props.tooltipFormat(obj.datum) : obj.datum.y)}\n        labelComponent={<CustomTooltip />}\n        voronoiBlacklist={this.props.series.map((_, idx) => this.props.name + '-scatter-' + idx)}\n      />\n    );\n    const hiddenAxisStyle = {\n      axis: { stroke: 'none' },\n      ticks: { stroke: 'none' },\n      tickLabels: { stroke: 'none', fill: 'none' }\n    };\n\n    return (\n      <Chart\n        {...this.props}\n        height={height}\n        width={this.state.width}\n        padding={padding}\n        events={events}\n        containerComponent={container}\n        // Hack: 1 pxl on Y domain padding to prevent harsh clipping (https://github.com/kiali/kiali/issues/2069)\n        domainPadding={{ y: 1 }}\n      >\n        <ChartAxis tickCount={15} style={hiddenAxisStyle} />\n        {this.props.showYAxis ? (\n          <ChartAxis\n            label=\"ops\"\n            axisLabelComponent={<ChartLabel y={0} x={15} angle={0} renderInPortal={true} />}\n            tickCount={2}\n            dependentAxis={true}\n          />\n        ) : (\n          <ChartAxis dependentAxis={true} style={hiddenAxisStyle} />\n        )}\n        {this.props.series.map((serie, idx) => {\n          if (this.state.hiddenSeries.has(idx)) {\n            return undefined;\n          }\n          return (\n            <ChartScatter\n              name={this.props.name + '-scatter-' + idx}\n              key={this.props.name + '-scatter-' + idx}\n              data={serie.datapoints}\n              style={{ data: { fill: serie.color } }}\n              size={({ active }) => (active ? 5 : 2)}\n            />\n          );\n        })}\n        {this.props.series.map((serie, idx) => {\n          if (this.state.hiddenSeries.has(idx)) {\n            return undefined;\n          }\n          return (\n            <ChartArea\n              name={this.props.name + '-area-' + idx}\n              key={this.props.name + '-area-' + idx}\n              data={serie.datapoints}\n              style={{\n                data: {\n                  fill: serie.color,\n                  fillOpacity: 0.2,\n                  stroke: serie.color,\n                  strokeWidth: 2\n                }\n              }}\n              interpolation={INTERPOTALION_STRATEGY}\n            />\n          );\n        })}\n        {this.props.showLegend && (\n          <VictoryLegend\n            name={this.props.name + '-legend'}\n            data={this.props.series.map((s, idx) => {\n              if (this.state.hiddenSeries.has(idx)) {\n                return { ...s.legendItem, symbol: { fill: '#72767b' } };\n              }\n              return s.legendItem;\n            })}\n            y={height - legendHeight}\n            height={legendHeight}\n            width={this.state.width}\n          />\n        )}\n      </Chart>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}