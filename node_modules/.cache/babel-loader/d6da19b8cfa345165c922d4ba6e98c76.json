{"ast":null,"code":"import _classCallCheck from \"/root/kiali-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/root/kiali-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/root/kiali-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/root/kiali-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"/root/kiali-ui/src/components/IstioWizards/RequestRouting/RuleBuilder.tsx\";\nimport * as React from 'react';\nimport { Button, Tabs, Tab } from '@patternfly/react-core';\nimport MatchBuilder from './MatchBuilder';\nimport Matches from './Matches';\nimport { style } from 'typestyle';\nimport TrafficShifting from '../TrafficShifting';\nimport FaultInjection from '../FaultInjection';\nimport { PFColors } from '../../Pf/PfColors';\nimport RequestTimeouts from '../RequestTimeouts';\nvar addRuleStyle = style({\n  width: '100%',\n  textAlign: 'right'\n});\nvar validationStyle = style({\n  marginRight: 20,\n  color: PFColors.Red100,\n  display: 'inline'\n});\n\nvar RuleBuilder = /*#__PURE__*/function (_React$Component) {\n  _inherits(RuleBuilder, _React$Component);\n\n  var _super = _createSuper(RuleBuilder);\n\n  function RuleBuilder(props) {\n    var _this;\n\n    _classCallCheck(this, RuleBuilder);\n\n    _this = _super.call(this, props);\n\n    _this.onWorkloadsToggle = function () {\n      _this.setState({\n        isWorkloadSelector: !_this.state.isWorkloadSelector\n      });\n    };\n\n    _this.ruleHandleTabClick = function (_event, tabIndex) {\n      _this.setState({\n        ruleTabKey: tabIndex\n      });\n    };\n\n    _this.state = {\n      isWorkloadSelector: false,\n      ruleTabKey: 0\n    };\n    return _this;\n  }\n\n  _createClass(RuleBuilder, [{\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Tabs, {\n        isFilled: true,\n        activeKey: this.state.ruleTabKey,\n        onSelect: this.ruleHandleTabClick,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(Tab, {\n        eventKey: 0,\n        title: 'Request Matching',\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          marginTop: '20px'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(MatchBuilder, Object.assign({}, this.props, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 15\n        }\n      })), /*#__PURE__*/React.createElement(Matches, Object.assign({}, this.props, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 15\n        }\n      })))), /*#__PURE__*/React.createElement(Tab, {\n        eventKey: 1,\n        title: 'Route To',\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          marginBottom: '10px'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(TrafficShifting, {\n        showValid: false,\n        workloads: this.props.workloads,\n        initWeights: this.props.weights,\n        showMirror: true,\n        onChange: this.props.onSelectWeights,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97,\n          columnNumber: 15\n        }\n      }))), /*#__PURE__*/React.createElement(Tab, {\n        eventKey: 2,\n        title: 'Fault Injection',\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          marginTop: '10px'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(FaultInjection, {\n        initFaultInjectionRoute: this.props.faultInjectionRoute,\n        onChange: this.props.onSelectFaultInjection,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 15\n        }\n      }))), /*#__PURE__*/React.createElement(Tab, {\n        eventKey: 3,\n        title: 'Request Timeouts',\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          marginTop: '10px'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(RequestTimeouts, {\n        initTimeoutRetry: this.props.timeoutRetryRoute,\n        onChange: this.props.onSelectTimeoutRetry,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116,\n          columnNumber: 15\n        }\n      })))), /*#__PURE__*/React.createElement(\"div\", {\n        className: addRuleStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 11\n        }\n      }, this.props.validationMsg.length > 0 && /*#__PURE__*/React.createElement(\"div\", {\n        className: validationStyle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 53\n        }\n      }, this.props.validationMsg), /*#__PURE__*/React.createElement(Button, {\n        variant: \"secondary\",\n        isDisabled: !this.props.isValid,\n        onClick: this.props.onAddRule,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 13\n        }\n      }, \"Add Route Rule\"))));\n    }\n  }]);\n\n  return RuleBuilder;\n}(React.Component);\n\nexport default RuleBuilder;","map":{"version":3,"sources":["/root/kiali-ui/src/components/IstioWizards/RequestRouting/RuleBuilder.tsx"],"names":["React","Button","Tabs","Tab","MatchBuilder","Matches","style","TrafficShifting","FaultInjection","PFColors","RequestTimeouts","addRuleStyle","width","textAlign","validationStyle","marginRight","color","Red100","display","RuleBuilder","props","onWorkloadsToggle","setState","isWorkloadSelector","state","ruleHandleTabClick","_event","tabIndex","ruleTabKey","marginTop","marginBottom","workloads","weights","onSelectWeights","faultInjectionRoute","onSelectFaultInjection","timeoutRetryRoute","onSelectTimeoutRetry","validationMsg","length","isValid","onAddRule","Component"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { Button, Tabs, Tab } from '@patternfly/react-core';\nimport MatchBuilder from './MatchBuilder';\nimport Matches from './Matches';\nimport { style } from 'typestyle';\nimport { WorkloadOverview } from '../../../types/ServiceInfo';\nimport TrafficShifting, { WorkloadWeight } from '../TrafficShifting';\nimport FaultInjection, { FaultInjectionRoute } from '../FaultInjection';\nimport { PFColors } from '../../Pf/PfColors';\nimport RequestTimeouts, { TimeoutRetryRoute } from '../RequestTimeouts';\n\ntype Props = {\n  // MatchBuilder props\n  category: string;\n  operator: string;\n  headerName: string;\n  matchValue: string;\n  isValid: boolean;\n  onSelectCategory: (category: string) => void;\n  onHeaderNameChange: (headerName: string) => void;\n  onSelectOperator: (operator: string) => void;\n  onMatchValueChange: (matchValue: string) => void;\n  onAddMatch: () => void;\n\n  // Matches props\n  matches: string[];\n  onRemoveMatch: (match: string) => void;\n\n  workloads: WorkloadOverview[];\n  weights: WorkloadWeight[];\n  onSelectWeights: (valid: boolean, workloads: WorkloadWeight[]) => void;\n\n  faultInjectionRoute: FaultInjectionRoute;\n  onSelectFaultInjection: (valid: boolean, faultInjectionRoute: FaultInjectionRoute) => void;\n\n  timeoutRetryRoute: TimeoutRetryRoute;\n  onSelectTimeoutRetry: (valid: boolean, timeoutRetryRoute: TimeoutRetryRoute) => void;\n\n  // RuleBuilder\n  validationMsg: string;\n  onAddRule: () => void;\n};\n\ntype State = {\n  isWorkloadSelector: boolean;\n  ruleTabKey: number;\n};\n\nconst addRuleStyle = style({\n  width: '100%',\n  textAlign: 'right'\n});\n\nconst validationStyle = style({\n  marginRight: 20,\n  color: PFColors.Red100,\n  display: 'inline'\n});\n\nclass RuleBuilder extends React.Component<Props, State> {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isWorkloadSelector: false,\n      ruleTabKey: 0\n    };\n  }\n\n  onWorkloadsToggle = () => {\n    this.setState({\n      isWorkloadSelector: !this.state.isWorkloadSelector\n    });\n  };\n\n  ruleHandleTabClick = (_event, tabIndex) => {\n    this.setState({\n      ruleTabKey: tabIndex\n    });\n  };\n\n  render() {\n    return (\n      <>\n        <Tabs isFilled={true} activeKey={this.state.ruleTabKey} onSelect={this.ruleHandleTabClick}>\n          <Tab eventKey={0} title={'Request Matching'}>\n            <div style={{ marginTop: '20px' }}>\n              <MatchBuilder {...this.props} />\n              <Matches {...this.props} />\n            </div>\n          </Tab>\n          <Tab eventKey={1} title={'Route To'}>\n            <div\n              style={{\n                marginBottom: '10px'\n              }}\n            >\n              <TrafficShifting\n                showValid={false}\n                workloads={this.props.workloads}\n                initWeights={this.props.weights}\n                showMirror={true}\n                onChange={this.props.onSelectWeights}\n              />\n            </div>\n          </Tab>\n          <Tab eventKey={2} title={'Fault Injection'}>\n            <div style={{ marginTop: '10px' }}>\n              <FaultInjection\n                initFaultInjectionRoute={this.props.faultInjectionRoute}\n                onChange={this.props.onSelectFaultInjection}\n              />\n            </div>\n          </Tab>\n          <Tab eventKey={3} title={'Request Timeouts'}>\n            <div style={{ marginTop: '10px' }}>\n              <RequestTimeouts\n                initTimeoutRetry={this.props.timeoutRetryRoute}\n                onChange={this.props.onSelectTimeoutRetry}\n              />\n            </div>\n          </Tab>\n        </Tabs>\n        <div className={addRuleStyle}>\n          <span>\n            {this.props.validationMsg.length > 0 && <div className={validationStyle}>{this.props.validationMsg}</div>}\n            <Button variant=\"secondary\" isDisabled={!this.props.isValid} onClick={this.props.onAddRule}>\n              Add Route Rule\n            </Button>\n          </span>\n        </div>\n      </>\n    );\n  }\n}\n\nexport default RuleBuilder;\n"]},"metadata":{},"sourceType":"module"}