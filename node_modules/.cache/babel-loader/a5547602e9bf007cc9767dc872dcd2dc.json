{"ast":null,"code":"import _regeneratorRuntime from\"/root/GraduateProject/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/root/GraduateProject/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/root/GraduateProject/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/root/GraduateProject/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/root/GraduateProject/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/root/GraduateProject/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import*as React from'react';import{connect}from'react-redux';import{LoginActions}from'../actions/LoginActions';import*as API from'../services/Api';import InitializingScreen from'./InitializingScreen';import authenticationConfig from'../config/AuthenticationConfig';import{setPFColorVals}from'components/Pf/PfColors';var InitializerComponent=/*#__PURE__*/function(_React$Component){_inherits(InitializerComponent,_React$Component);var _super=_createSuper(InitializerComponent);function InitializerComponent(props){var _this;_classCallCheck(this,InitializerComponent);_this=_super.call(this,props);_this.fetchAuthenticationConfig=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var authConfig,errDetails,response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return API.getAuthInfo();case 3:authConfig=_context.sent;authenticationConfig.authorizationEndpoint=authConfig.data.authorizationEndpoint;authenticationConfig.logoutEndpoint=authConfig.data.logoutEndpoint;authenticationConfig.logoutRedirect=authConfig.data.logoutRedirect;authenticationConfig.strategy=authConfig.data.strategy;if(authConfig.data.sessionInfo.expiresOn&&authConfig.data.sessionInfo.username){_this.props.setInitialAuthentication({username:authConfig.data.sessionInfo.username,expiresOn:authConfig.data.sessionInfo.expiresOn});}_this.props.onInitializationFinished();_context.next=16;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](0);if(_context.t0.request){response=_context.t0.request.responseText;if(response.trim().length>0){errDetails=response;}}_this.setState({errorMsg:API.getErrorString(_context.t0),errorDetails:errDetails});case 16:case\"end\":return _context.stop();}}},_callee,null,[[0,12]]);}));_this.state={};return _this;}_createClass(InitializerComponent,[{key:\"componentDidMount\",value:function componentDidMount(){this.fetchAuthenticationConfig();setPFColorVals(document.documentElement);}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(InitializingScreen,{errorMsg:this.state.errorMsg,errorDetails:this.state.errorDetails});}}]);return InitializerComponent;}(React.Component);var mapDispatchToProps=function mapDispatchToProps(dispatch){return{setInitialAuthentication:function setInitialAuthentication(session){return dispatch(LoginActions.loginSuccess(session));}};};var StartupInitializer=connect(null,mapDispatchToProps)(InitializerComponent);export default StartupInitializer;","map":null,"metadata":{},"sourceType":"module"}