{"ast":null,"code":"var _this = this,\n    _jsxFileName = \"/root/kiali-ui/src/components/Charts/Container.tsx\";\n\nimport * as React from 'react';\nimport { VictoryVoronoiContainer, createContainer } from 'victory';\nimport { format as d3Format } from 'd3-format';\nimport { getFormatter } from 'utils/Formatter';\n\nvar formatValue = function formatValue(label, datum, value) {\n  // Formats a value based on unit and scale factor.\n  // Scale factor is usually undefined, except when a second axis is in use (then it's the ratio between first axis and second axis maxs)\n  return label + ': ' + getFormatter(d3Format, datum.unit, true)(value / (datum.scaleFactor || 1));\n};\n\nexport var newBrushVoronoiContainer = function newBrushVoronoiContainer(labelComponent, handlers, hideTooltip) {\n  var voronoiProps = {\n    labels: function labels(obj) {\n      if (obj.datum.hideLabel || hideTooltip()) {\n        return '';\n      }\n\n      if (obj.datum._median !== undefined) {\n        // Buckets display => datapoint is expected to have _median, _min, _max, _q1, _q3 stats\n        var avg = obj.datum.y.reduce(function (s, y) {\n          return s + y;\n        }, 0) / obj.datum.y.length;\n        return \"\".concat(obj.datum.name, \" (\").concat(obj.datum.y.length, \" datapoints)\\n          \").concat(formatValue('avg', obj.datum, avg), \", \").concat(formatValue('min', obj.datum, obj.datum._min), \", \").concat(formatValue('max', obj.datum, obj.datum._max), \"\\n          \").concat(formatValue('p25', obj.datum, obj.datum._q1), \", \").concat(formatValue('p50', obj.datum, obj.datum._median), \", \").concat(formatValue('p75', obj.datum, obj.datum._q3));\n      }\n\n      return formatValue(obj.datum.name, obj.datum, obj.datum.y);\n    },\n    labelComponent: labelComponent,\n    // We blacklist \"parent\" as a workaround to avoid the VictoryVoronoiContainer crashing.\n    // See https://github.com/FormidableLabs/victory/issues/1355\n    voronoiBlacklist: ['parent']\n  };\n\n  if (handlers) {\n    var VoronoiBrushContainer = createContainer('brush', 'voronoi');\n    return /*#__PURE__*/React.createElement(VoronoiBrushContainer, Object.assign({\n      brushDimension: 'x',\n      brushDomain: {\n        x: [0, 0]\n      },\n      brushStyle: {\n        stroke: 'transparent',\n        fill: 'blue',\n        fillOpacity: 0.1\n      },\n      defaultBrushArea: 'none',\n      onBrushCleared: handlers.onCleared,\n      onBrushDomainChange: handlers.onDomainChange,\n      onBrushDomainChangeEnd: handlers.onDomainChangeEnd\n    }, voronoiProps, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64,\n        columnNumber: 7\n      }\n    }));\n  }\n\n  return /*#__PURE__*/React.createElement(VictoryVoronoiContainer, Object.assign({}, voronoiProps, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 10\n    }\n  }));\n};","map":{"version":3,"sources":["/root/kiali-ui/src/components/Charts/Container.tsx"],"names":["React","VictoryVoronoiContainer","createContainer","format","d3Format","getFormatter","formatValue","label","datum","value","unit","scaleFactor","newBrushVoronoiContainer","labelComponent","handlers","hideTooltip","voronoiProps","labels","obj","hideLabel","_median","undefined","avg","y","reduce","s","length","name","_min","_max","_q1","_q3","voronoiBlacklist","VoronoiBrushContainer","x","stroke","fill","fillOpacity","onCleared","onDomainChange","onDomainChangeEnd"],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { VictoryVoronoiContainer, createContainer } from 'victory';\nimport { DomainTuple } from 'victory-core';\nimport { VictoryVoronoiContainerProps } from 'victory-voronoi-container';\nimport { VictoryBrushContainerProps } from 'victory-brush-container';\nimport { format as d3Format } from 'd3-format';\nimport { getFormatter } from 'utils/Formatter';\nimport { RichDataPoint } from 'types/VictoryChartInfo';\n\ntype BrushDomain = { x: DomainTuple; y: DomainTuple };\n\nexport type BrushHandlers = {\n  /* eslint-disable @typescript-eslint/no-explicit-any */\n  onCleared?: (domain: BrushDomain, props: any) => void;\n  onDomainChange?: (domain: BrushDomain, props: any) => void;\n  onDomainChangeEnd?: (domain: BrushDomain, props: any) => void;\n  /* eslint-enable @typescript-eslint/no-explicit-any */\n};\n\nconst formatValue = (label: string, datum: RichDataPoint, value: number) => {\n  // Formats a value based on unit and scale factor.\n  // Scale factor is usually undefined, except when a second axis is in use (then it's the ratio between first axis and second axis maxs)\n  return label + ': ' + getFormatter(d3Format, datum.unit!, true)(value / (datum.scaleFactor || 1));\n};\n\nexport const newBrushVoronoiContainer = (\n  labelComponent: JSX.Element,\n  handlers: BrushHandlers | undefined,\n  hideTooltip: () => boolean\n) => {\n  const voronoiProps = {\n    labels: obj => {\n      if (obj.datum.hideLabel || hideTooltip()) {\n        return '';\n      }\n      if (obj.datum._median !== undefined) {\n        // Buckets display => datapoint is expected to have _median, _min, _max, _q1, _q3 stats\n        const avg = obj.datum.y.reduce((s, y) => s + y, 0) / obj.datum.y.length;\n        return `${obj.datum.name} (${obj.datum.y.length} datapoints)\n          ${formatValue('avg', obj.datum, avg)}, ${formatValue('min', obj.datum, obj.datum._min)}, ${formatValue(\n          'max',\n          obj.datum,\n          obj.datum._max\n        )}\n          ${formatValue('p25', obj.datum, obj.datum._q1)}, ${formatValue(\n          'p50',\n          obj.datum,\n          obj.datum._median\n        )}, ${formatValue('p75', obj.datum, obj.datum._q3)}`;\n      }\n      return formatValue(obj.datum.name, obj.datum, obj.datum.y);\n    },\n    labelComponent: labelComponent,\n    // We blacklist \"parent\" as a workaround to avoid the VictoryVoronoiContainer crashing.\n    // See https://github.com/FormidableLabs/victory/issues/1355\n    voronoiBlacklist: ['parent']\n  };\n  if (handlers) {\n    const VoronoiBrushContainer = createContainer<VictoryVoronoiContainerProps, VictoryBrushContainerProps>(\n      'brush',\n      'voronoi'\n    );\n    return (\n      <VoronoiBrushContainer\n        brushDimension={'x'}\n        brushDomain={{ x: [0, 0] }}\n        brushStyle={{ stroke: 'transparent', fill: 'blue', fillOpacity: 0.1 }}\n        defaultBrushArea={'none'}\n        onBrushCleared={handlers.onCleared}\n        onBrushDomainChange={handlers.onDomainChange}\n        onBrushDomainChangeEnd={handlers.onDomainChangeEnd}\n        {...voronoiProps}\n      />\n    );\n  }\n  return <VictoryVoronoiContainer {...voronoiProps} />;\n};\n"]},"metadata":{},"sourceType":"module"}