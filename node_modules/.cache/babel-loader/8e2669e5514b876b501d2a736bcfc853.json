{"ast":null,"code":"import _toConsumableArray from \"/root/kiali-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"/root/kiali-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/root/kiali-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/root/kiali-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/root/kiali-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"/root/kiali-ui/src/pages/Graph/GraphToolbar/GraphTraffic.tsx\";\nimport { Radio, Dropdown, DropdownToggle, Checkbox, Tooltip, TooltipPosition } from '@patternfly/react-core';\nimport * as React from 'react';\nimport { connect } from 'react-redux';\nimport { bindActionCreators } from 'redux';\nimport { GraphToolbarActions } from '../../../actions/GraphToolbarActions';\nimport { TrafficRate, isGrpcRate, isHttpRate, isTcpRate } from '../../../types/Graph';\nimport * as _ from 'lodash';\nimport { trafficRatesSelector } from 'store/Selectors';\nimport { BoundingClientAwareComponent, PropertyType } from 'components/BoundingClientAwareComponent/BoundingClientAwareComponent';\nimport { KialiIcon } from 'config/KialiIcon';\nimport { containerStyle, infoStyle, itemStyleWithInfo, itemStyleWithoutInfo, menuStyle, menuEntryStyle } from 'styles/DropdownStyles';\nvar marginBottom = 20;\n\nvar GraphTraffic = /*#__PURE__*/function (_React$PureComponent) {\n  _inherits(GraphTraffic, _React$PureComponent);\n\n  var _super = _createSuper(GraphTraffic);\n\n  function GraphTraffic(props) {\n    var _this;\n\n    _classCallCheck(this, GraphTraffic);\n\n    _this = _super.call(this, props);\n\n    _this.onToggle = function (isOpen) {\n      _this.setState({\n        isOpen: isOpen\n      });\n    };\n\n    _this.toggleTrafficRate = function (_, event) {\n      var rate = event.target.value;\n\n      if (_this.props.trafficRates.includes(rate)) {\n        var newRates;\n\n        switch (rate) {\n          case TrafficRate.GRPC_GROUP:\n            newRates = _this.props.trafficRates.filter(function (r) {\n              return !isGrpcRate(r);\n            });\n            break;\n\n          case TrafficRate.HTTP_GROUP:\n            newRates = _this.props.trafficRates.filter(function (r) {\n              return !isHttpRate(r);\n            });\n            break;\n\n          case TrafficRate.TCP_GROUP:\n            newRates = _this.props.trafficRates.filter(function (r) {\n              return !isTcpRate(r);\n            });\n            break;\n\n          default:\n            newRates = _this.props.trafficRates.filter(function (r) {\n              return r !== rate;\n            });\n        }\n\n        _this.props.setTrafficRates(newRates);\n      } else {\n        switch (rate) {\n          case TrafficRate.GRPC_GROUP:\n            _this.props.setTrafficRates([].concat(_toConsumableArray(_this.props.trafficRates), [rate, TrafficRate.GRPC_REQUEST]));\n\n            break;\n\n          case TrafficRate.HTTP_GROUP:\n            _this.props.setTrafficRates([].concat(_toConsumableArray(_this.props.trafficRates), [rate, TrafficRate.HTTP_REQUEST]));\n\n            break;\n\n          case TrafficRate.TCP_GROUP:\n            _this.props.setTrafficRates([].concat(_toConsumableArray(_this.props.trafficRates), [rate, TrafficRate.TCP_SENT]));\n\n            break;\n\n          default:\n            _this.props.setTrafficRates([].concat(_toConsumableArray(_this.props.trafficRates), [rate]));\n\n        }\n      }\n    };\n\n    _this.toggleTrafficRateHttp = function (_, event) {\n      var rate = event.target.value;\n\n      var newRates = _this.props.trafficRates.filter(function (r) {\n        return !isHttpRate(r);\n      });\n\n      _this.props.setTrafficRates([].concat(_toConsumableArray(newRates), [TrafficRate.HTTP_GROUP, rate]));\n    };\n\n    _this.state = {\n      isOpen: false\n    };\n    return _this;\n  }\n\n  _createClass(GraphTraffic, [{\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/React.createElement(Dropdown, {\n        toggle: /*#__PURE__*/React.createElement(DropdownToggle, {\n          id: \"graph-traffic-dropdown\",\n          onToggle: this.onToggle,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 66,\n            columnNumber: 11\n          }\n        }, \"Traffic\"),\n        disabled: this.props.disabled,\n        isOpen: this.state.isOpen,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 7\n        }\n      }, this.getPopoverContent());\n    }\n  }, {\n    key: \"getPopoverContent\",\n    value: function getPopoverContent() {\n      var _this2 = this;\n\n      var trafficRates = this.props.trafficRates;\n      var trafficRateOptions = [// {\n      //   id: TrafficRate.GRPC_GROUP,\n      //   labelText: _.startCase(TrafficRate.GRPC_GROUP),\n      //   isChecked: trafficRates.includes(TrafficRate.GRPC_GROUP),\n      //   tooltip: (\n      //     <div style={{ textAlign: 'left' }}>\n      //       Displays active gRPC Edges for the time period, using the selected gRPC rate. To see idle gRPC Edges enable\n      //       the \"Idle Edges\" Display menu option. Default: Requests.\n      //     </div>\n      //   )\n      // },\n      {\n        id: TrafficRate.HTTP_GROUP,\n        labelText: _.startCase(TrafficRate.HTTP_GROUP),\n        isChecked: trafficRates.includes(TrafficRate.HTTP_GROUP) // tooltip: (\n        //   <div style={{ textAlign: 'left' }}>\n        //     Displays active HTTP Edges for the time period, using the selected HTTP rate. To see idle HTTP Edges enable\n        //     the \"Idle Edges\" Display menu option. Default: Requests.\n        //   </div>\n        // )\n\n      } // {\n      //   id: TrafficRate.TCP_GROUP,\n      //   labelText: _.startCase(TrafficRate.TCP_GROUP),\n      //   isChecked: trafficRates.includes(TrafficRate.TCP_GROUP),\n      //   tooltip: (\n      //     <div style={{ textAlign: 'left' }}>\n      //       Displays active TCP Edges for the time period, using the selected TCP rate. To see inactive TCP Edges enable\n      //       the \"Idle Edges\" Display menu option. Default: Sent Bytes.\n      //     </div>\n      //   )\n      // }\n      ]; // const grpcOptions: TrafficRateOptionType[] = [\n      //   {\n      //     id: TrafficRate.GRPC_RECEIVED,\n      //     labelText: 'Received Messages',\n      //     isChecked: trafficRates.includes(TrafficRate.GRPC_RECEIVED),\n      //     tooltip: (\n      //       <div style={{ textAlign: 'left' }}>\n      //         Received (i.e. Response) message rate in messages-per-second (mps). Captures server streaming RPCs.\n      //       </div>\n      //     )\n      //   },\n      //   {\n      //     id: TrafficRate.GRPC_REQUEST,\n      //     labelText: 'Requests',\n      //     isChecked: trafficRates.includes(TrafficRate.GRPC_REQUEST),\n      //     tooltip: (\n      //       <div style={{ textAlign: 'left' }}>\n      //         Request message rate in requests-per-second (rps). Captures unary RPC, with status codes.\n      //       </div>\n      //     )\n      //   },\n      //   {\n      //     id: TrafficRate.GRPC_SENT,\n      //     labelText: 'Sent Messages',\n      //     isChecked: trafficRates.includes(TrafficRate.GRPC_SENT),\n      //     tooltip: (\n      //       <div style={{ textAlign: 'left' }}>\n      //         Sent (i.e. Request) message rate in messages-per-second (mps). Captures client streaming RPCs.\n      //       </div>\n      //     )\n      //   },\n      //   {\n      //     id: TrafficRate.GRPC_TOTAL,\n      //     labelText: 'Total Messages',\n      //     isChecked: trafficRates.includes(TrafficRate.GRPC_TOTAL),\n      //     tooltip: (\n      //       <div style={{ textAlign: 'left' }}>\n      //         Combined (Sent + Received) message rate in messages-per-second (mps). Captures all streaming RPCs.\n      //       </div>\n      //     )\n      //   }\n      // ];\n\n      var httpOptions = [{\n        id: TrafficRate.HTTP_REQUEST,\n        labelText: 'Requests',\n        isChecked: trafficRates.includes(TrafficRate.HTTP_REQUEST) // tooltip: (\n        //   <div style={{ textAlign: 'left' }}>\n        //     Request message rate in requests-per-second (rps). Captures status codes.\n        //   </div>\n        // )\n\n      }]; // const tcpOptions: TrafficRateOptionType[] = [\n      //   {\n      //     id: TrafficRate.TCP_RECEIVED,\n      //     labelText: 'Received Bytes',\n      //     isChecked: trafficRates.includes(TrafficRate.TCP_RECEIVED),\n      //     tooltip: <div style={{ textAlign: 'left' }}>Received bytes rate in bytes-per-second (bps).</div>\n      //   },\n      //   {\n      //     id: TrafficRate.TCP_SENT,\n      //     labelText: 'Sent Bytes',\n      //     isChecked: trafficRates.includes(TrafficRate.TCP_SENT),\n      //     tooltip: <div style={{ textAlign: 'left' }}>Sent bytes rate in bytes-per-second (bps).</div>\n      //   },\n      //   {\n      //     id: TrafficRate.TCP_TOTAL,\n      //     labelText: 'Total Bytes',\n      //     isChecked: trafficRates.includes(TrafficRate.TCP_TOTAL),\n      //     tooltip: (\n      //       <div style={{ textAlign: 'left' }}>Combined (Sent + Received) byte rate in bytes-per-second (mps).</div>\n      //     )\n      //   }\n      // ];\n\n      return /*#__PURE__*/React.createElement(BoundingClientAwareComponent, {\n        className: containerStyle,\n        maxHeight: {\n          type: PropertyType.VIEWPORT_HEIGHT_MINUS_TOP,\n          margin: marginBottom\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        id: \"graph-traffic-menu\",\n        className: menuStyle,\n        style: {\n          width: '16.5em'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 201,\n          columnNumber: 9\n        }\n      }, trafficRateOptions.map(function (trafficRateOption) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          key: trafficRateOption.id,\n          className: menuEntryStyle,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 13\n          }\n        }, /*#__PURE__*/React.createElement(\"label\", {\n          key: trafficRateOption.id,\n          className: !!trafficRateOption.tooltip ? itemStyleWithInfo : itemStyleWithoutInfo,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 204,\n            columnNumber: 15\n          }\n        }, /*#__PURE__*/React.createElement(Checkbox, {\n          id: trafficRateOption.id,\n          name: \"trafficRateOptions\",\n          isChecked: trafficRateOption.isChecked,\n          label: trafficRateOption.labelText,\n          onChange: _this2.toggleTrafficRate,\n          value: trafficRateOption.id,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 17\n          }\n        })), !!trafficRateOption.tooltip && /*#__PURE__*/React.createElement(Tooltip, {\n          key: \"tooltip_\".concat(trafficRateOption.id),\n          position: TooltipPosition.right,\n          content: trafficRateOption.tooltip,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 218,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(KialiIcon.Info, {\n          className: infoStyle,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 19\n          }\n        })), trafficRateOption.id === TrafficRate.HTTP_GROUP && httpOptions.some(function (o) {\n          return o.isChecked;\n        }) && /*#__PURE__*/React.createElement(\"div\", {\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 259,\n            columnNumber: 17\n          }\n        }, httpOptions.map(function (httpOption) {\n          return /*#__PURE__*/React.createElement(\"div\", {\n            key: httpOption.id,\n            className: menuEntryStyle,\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 261,\n              columnNumber: 21\n            }\n          }, /*#__PURE__*/React.createElement(\"label\", {\n            key: httpOption.id,\n            className: !!httpOption.tooltip ? itemStyleWithInfo : itemStyleWithoutInfo,\n            style: {\n              paddingLeft: '35px'\n            },\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 262,\n              columnNumber: 23\n            }\n          }, /*#__PURE__*/React.createElement(Radio, {\n            id: httpOption.id,\n            style: {\n              paddingLeft: '5px'\n            },\n            name: \"httpOptions\",\n            isChecked: httpOption.isChecked,\n            label: httpOption.labelText,\n            onChange: _this2.toggleTrafficRateHttp,\n            value: httpOption.id,\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 267,\n              columnNumber: 25\n            }\n          })), !!httpOption.tooltip && /*#__PURE__*/React.createElement(Tooltip, {\n            key: \"tooltip_\".concat(httpOption.id),\n            position: TooltipPosition.right,\n            content: httpOption.tooltip,\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 278,\n              columnNumber: 25\n            }\n          }, /*#__PURE__*/React.createElement(KialiIcon.Info, {\n            className: infoStyle,\n            __self: _this2,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 283,\n              columnNumber: 27\n            }\n          })));\n        })));\n      })));\n    } // private toggleTrafficRateTcp = (_, event) => {\n    //   const rate = event.target.value as TrafficRate;\n    //   const newRates = this.props.trafficRates.filter(r => !isTcpRate(r));\n    //   this.props.setTrafficRates([...newRates, TrafficRate.TCP_GROUP, rate]);\n    // };\n\n  }]);\n\n  return GraphTraffic;\n}(React.PureComponent); // Allow Redux to map sections of our global app state to our props\n\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    trafficRates: trafficRatesSelector(state)\n  };\n}; // Map our actions to Redux\n\n\nvar mapDispatchToProps = function mapDispatchToProps(dispatch) {\n  return {\n    setTrafficRates: bindActionCreators(GraphToolbarActions.setTrafficRates, dispatch)\n  };\n}; // hook up to Redux for our State to be mapped to props\n\n\nvar GraphTrafficContainer = connect(mapStateToProps, mapDispatchToProps)(GraphTraffic);\nexport default GraphTrafficContainer;","map":{"version":3,"sources":["/root/kiali-ui/src/pages/Graph/GraphToolbar/GraphTraffic.tsx"],"names":["Radio","Dropdown","DropdownToggle","Checkbox","Tooltip","TooltipPosition","React","connect","bindActionCreators","GraphToolbarActions","TrafficRate","isGrpcRate","isHttpRate","isTcpRate","_","trafficRatesSelector","BoundingClientAwareComponent","PropertyType","KialiIcon","containerStyle","infoStyle","itemStyleWithInfo","itemStyleWithoutInfo","menuStyle","menuEntryStyle","marginBottom","GraphTraffic","props","onToggle","isOpen","setState","toggleTrafficRate","event","rate","target","value","trafficRates","includes","newRates","GRPC_GROUP","filter","r","HTTP_GROUP","TCP_GROUP","setTrafficRates","GRPC_REQUEST","HTTP_REQUEST","TCP_SENT","toggleTrafficRateHttp","state","disabled","getPopoverContent","trafficRateOptions","id","labelText","startCase","isChecked","httpOptions","type","VIEWPORT_HEIGHT_MINUS_TOP","margin","width","map","trafficRateOption","tooltip","right","some","o","httpOption","paddingLeft","PureComponent","mapStateToProps","mapDispatchToProps","dispatch","GraphTrafficContainer"],"mappings":";;;;;;AAAA,SAASA,KAAT,EAAgBC,QAAhB,EAA0BC,cAA1B,EAA0CC,QAA1C,EAAoDC,OAApD,EAA6DC,eAA7D,QAAoF,wBAApF;AACA,OAAO,KAAKC,KAAZ,MAAuB,OAAvB;AACA,SAASC,OAAT,QAAwB,aAAxB;AAEA,SAASC,kBAAT,QAAmC,OAAnC;AAEA,SAASC,mBAAT,QAAoC,sCAApC;AACA,SAASC,WAAT,EAAsBC,UAAtB,EAAkCC,UAAlC,EAA8CC,SAA9C,QAA+D,sBAA/D;AAEA,OAAO,KAAKC,CAAZ,MAAmB,QAAnB;AACA,SAASC,oBAAT,QAAqC,iBAArC;AACA,SACEC,4BADF,EAEEC,YAFF,QAGO,sEAHP;AAIA,SAASC,SAAT,QAA0B,kBAA1B;AACA,SACEC,cADF,EAEEC,SAFF,EAGEC,iBAHF,EAIEC,oBAJF,EAKEC,SALF,EAMEC,cANF,QAOO,uBAPP;AA6BA,IAAMC,YAAY,GAAG,EAArB;;IAEMC,Y;;;;;AACJ,wBAAYC,KAAZ,EAAsC;AAAA;;AAAA;;AACpC,8BAAMA,KAAN;;AADoC,UAO9BC,QAP8B,GAOnB,UAAAC,MAAM,EAAI;AAC3B,YAAKC,QAAL,CAAc;AACZD,QAAAA,MAAM,EAANA;AADY,OAAd;AAGD,KAXqC;;AAAA,UAwR9BE,iBAxR8B,GAwRV,UAACjB,CAAD,EAAIkB,KAAJ,EAAc;AACxC,UAAMC,IAAI,GAAGD,KAAK,CAACE,MAAN,CAAaC,KAA1B;;AACA,UAAI,MAAKR,KAAL,CAAWS,YAAX,CAAwBC,QAAxB,CAAiCJ,IAAjC,CAAJ,EAA4C;AAC1C,YAAIK,QAAJ;;AACA,gBAAQL,IAAR;AACE,eAAKvB,WAAW,CAAC6B,UAAjB;AACED,YAAAA,QAAQ,GAAG,MAAKX,KAAL,CAAWS,YAAX,CAAwBI,MAAxB,CAA+B,UAAAC,CAAC;AAAA,qBAAI,CAAC9B,UAAU,CAAC8B,CAAD,CAAf;AAAA,aAAhC,CAAX;AACA;;AACF,eAAK/B,WAAW,CAACgC,UAAjB;AACEJ,YAAAA,QAAQ,GAAG,MAAKX,KAAL,CAAWS,YAAX,CAAwBI,MAAxB,CAA+B,UAAAC,CAAC;AAAA,qBAAI,CAAC7B,UAAU,CAAC6B,CAAD,CAAf;AAAA,aAAhC,CAAX;AACA;;AACF,eAAK/B,WAAW,CAACiC,SAAjB;AACEL,YAAAA,QAAQ,GAAG,MAAKX,KAAL,CAAWS,YAAX,CAAwBI,MAAxB,CAA+B,UAAAC,CAAC;AAAA,qBAAI,CAAC5B,SAAS,CAAC4B,CAAD,CAAd;AAAA,aAAhC,CAAX;AACA;;AACF;AACEH,YAAAA,QAAQ,GAAG,MAAKX,KAAL,CAAWS,YAAX,CAAwBI,MAAxB,CAA+B,UAAAC,CAAC;AAAA,qBAAIA,CAAC,KAAKR,IAAV;AAAA,aAAhC,CAAX;AAXJ;;AAaA,cAAKN,KAAL,CAAWiB,eAAX,CAA2BN,QAA3B;AACD,OAhBD,MAgBO;AACL,gBAAQL,IAAR;AACE,eAAKvB,WAAW,CAAC6B,UAAjB;AACE,kBAAKZ,KAAL,CAAWiB,eAAX,8BAA+B,MAAKjB,KAAL,CAAWS,YAA1C,IAAwDH,IAAxD,EAA8DvB,WAAW,CAACmC,YAA1E;;AACA;;AACF,eAAKnC,WAAW,CAACgC,UAAjB;AACE,kBAAKf,KAAL,CAAWiB,eAAX,8BAA+B,MAAKjB,KAAL,CAAWS,YAA1C,IAAwDH,IAAxD,EAA8DvB,WAAW,CAACoC,YAA1E;;AACA;;AACF,eAAKpC,WAAW,CAACiC,SAAjB;AACE,kBAAKhB,KAAL,CAAWiB,eAAX,8BAA+B,MAAKjB,KAAL,CAAWS,YAA1C,IAAwDH,IAAxD,EAA8DvB,WAAW,CAACqC,QAA1E;;AACA;;AACF;AACE,kBAAKpB,KAAL,CAAWiB,eAAX,8BAA+B,MAAKjB,KAAL,CAAWS,YAA1C,IAAwDH,IAAxD;;AAXJ;AAaD;AACF,KAzTqC;;AAAA,UAiU9Be,qBAjU8B,GAiUN,UAAClC,CAAD,EAAIkB,KAAJ,EAAc;AAC5C,UAAMC,IAAI,GAAGD,KAAK,CAACE,MAAN,CAAaC,KAA1B;;AACA,UAAMG,QAAQ,GAAG,MAAKX,KAAL,CAAWS,YAAX,CAAwBI,MAAxB,CAA+B,UAAAC,CAAC;AAAA,eAAI,CAAC7B,UAAU,CAAC6B,CAAD,CAAf;AAAA,OAAhC,CAAjB;;AACA,YAAKd,KAAL,CAAWiB,eAAX,8BAA+BN,QAA/B,IAAyC5B,WAAW,CAACgC,UAArD,EAAiET,IAAjE;AACD,KArUqC;;AAEpC,UAAKgB,KAAL,GAAa;AACXpB,MAAAA,MAAM,EAAE;AADG,KAAb;AAFoC;AAKrC;;;;WAQD,kBAAS;AACP,0BACE,oBAAC,QAAD;AACE,QAAA,MAAM,eACJ,oBAAC,cAAD;AAAgB,UAAA,EAAE,EAAC,wBAAnB;AAA4C,UAAA,QAAQ,EAAE,KAAKD,QAA3D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAFJ;AAME,QAAA,QAAQ,EAAE,KAAKD,KAAL,CAAWuB,QANvB;AAOE,QAAA,MAAM,EAAE,KAAKD,KAAL,CAAWpB,MAPrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SASG,KAAKsB,iBAAL,EATH,CADF;AAaD;;;WAED,6BAA4B;AAAA;;AAC1B,UAAMf,YAAY,GAAG,KAAKT,KAAL,CAAWS,YAAhC;AAEA,UAAMgB,kBAA2C,GAAG,CAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACEC,QAAAA,EAAE,EAAE3C,WAAW,CAACgC,UADlB;AAEEY,QAAAA,SAAS,EAAExC,CAAC,CAACyC,SAAF,CAAY7C,WAAW,CAACgC,UAAxB,CAFb;AAGEc,QAAAA,SAAS,EAAEpB,YAAY,CAACC,QAAb,CAAsB3B,WAAW,CAACgC,UAAlC,CAHb,CAIE;AACA;AACA;AACA;AACA;AACA;;AATF,OAZkD,CAuBlD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAjCkD,OAApD,CAH0B,CAuC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,UAAMe,WAAoC,GAAG,CAC3C;AACEJ,QAAAA,EAAE,EAAE3C,WAAW,CAACoC,YADlB;AAEEQ,QAAAA,SAAS,EAAE,UAFb;AAGEE,QAAAA,SAAS,EAAEpB,YAAY,CAACC,QAAb,CAAsB3B,WAAW,CAACoC,YAAlC,CAHb,CAIE;AACA;AACA;AACA;AACA;;AARF,OAD2C,CAA7C,CAlF0B,CA+F1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,0BACE,oBAAC,4BAAD;AACE,QAAA,SAAS,EAAE3B,cADb;AAEE,QAAA,SAAS,EAAE;AAAEuC,UAAAA,IAAI,EAAEzC,YAAY,CAAC0C,yBAArB;AAAgDC,UAAAA,MAAM,EAAEnC;AAAxD,SAFb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAIE;AAAK,QAAA,EAAE,EAAC,oBAAR;AAA6B,QAAA,SAAS,EAAEF,SAAxC;AAAmD,QAAA,KAAK,EAAE;AAAEsC,UAAAA,KAAK,EAAE;AAAT,SAA1D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACGT,kBAAkB,CAACU,GAAnB,CAAuB,UAACC,iBAAD;AAAA,4BACtB;AAAK,UAAA,GAAG,EAAEA,iBAAiB,CAACV,EAA5B;AAAgC,UAAA,SAAS,EAAE7B,cAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBACE;AACE,UAAA,GAAG,EAAEuC,iBAAiB,CAACV,EADzB;AAEE,UAAA,SAAS,EAAE,CAAC,CAACU,iBAAiB,CAACC,OAApB,GAA8B3C,iBAA9B,GAAkDC,oBAF/D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAIE,oBAAC,QAAD;AACE,UAAA,EAAE,EAAEyC,iBAAiB,CAACV,EADxB;AAEE,UAAA,IAAI,EAAC,oBAFP;AAGE,UAAA,SAAS,EAAEU,iBAAiB,CAACP,SAH/B;AAIE,UAAA,KAAK,EAAEO,iBAAiB,CAACT,SAJ3B;AAKE,UAAA,QAAQ,EAAE,MAAI,CAACvB,iBALjB;AAME,UAAA,KAAK,EAAEgC,iBAAiB,CAACV,EAN3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAJF,CADF,EAcG,CAAC,CAACU,iBAAiB,CAACC,OAApB,iBACC,oBAAC,OAAD;AACE,UAAA,GAAG,oBAAaD,iBAAiB,CAACV,EAA/B,CADL;AAEE,UAAA,QAAQ,EAAEhD,eAAe,CAAC4D,KAF5B;AAGE,UAAA,OAAO,EAAEF,iBAAiB,CAACC,OAH7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAKE,oBAAC,SAAD,CAAW,IAAX;AAAgB,UAAA,SAAS,EAAE5C,SAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UALF,CAfJ,EAuDG2C,iBAAiB,CAACV,EAAlB,KAAyB3C,WAAW,CAACgC,UAArC,IAAmDe,WAAW,CAACS,IAAZ,CAAiB,UAAAC,CAAC;AAAA,iBAAIA,CAAC,CAACX,SAAN;AAAA,SAAlB,CAAnD,iBACC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACGC,WAAW,CAACK,GAAZ,CAAgB,UAACM,UAAD;AAAA,8BACf;AAAK,YAAA,GAAG,EAAEA,UAAU,CAACf,EAArB;AAAyB,YAAA,SAAS,EAAE7B,cAApC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BACE;AACE,YAAA,GAAG,EAAE4C,UAAU,CAACf,EADlB;AAEE,YAAA,SAAS,EAAE,CAAC,CAACe,UAAU,CAACJ,OAAb,GAAuB3C,iBAAvB,GAA2CC,oBAFxD;AAGE,YAAA,KAAK,EAAE;AAAE+C,cAAAA,WAAW,EAAE;AAAf,aAHT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAKE,oBAAC,KAAD;AACE,YAAA,EAAE,EAAED,UAAU,CAACf,EADjB;AAEE,YAAA,KAAK,EAAE;AAAEgB,cAAAA,WAAW,EAAE;AAAf,aAFT;AAGE,YAAA,IAAI,EAAC,aAHP;AAIE,YAAA,SAAS,EAAED,UAAU,CAACZ,SAJxB;AAKE,YAAA,KAAK,EAAEY,UAAU,CAACd,SALpB;AAME,YAAA,QAAQ,EAAE,MAAI,CAACN,qBANjB;AAOE,YAAA,KAAK,EAAEoB,UAAU,CAACf,EAPpB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YALF,CADF,EAgBG,CAAC,CAACe,UAAU,CAACJ,OAAb,iBACC,oBAAC,OAAD;AACE,YAAA,GAAG,oBAAaI,UAAU,CAACf,EAAxB,CADL;AAEE,YAAA,QAAQ,EAAEhD,eAAe,CAAC4D,KAF5B;AAGE,YAAA,OAAO,EAAEG,UAAU,CAACJ,OAHtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAKE,oBAAC,SAAD,CAAW,IAAX;AAAgB,YAAA,SAAS,EAAE5C,SAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YALF,CAjBJ,CADe;AAAA,SAAhB,CADH,CAxDJ,CADsB;AAAA,OAAvB,CADH,CAJF,CADF;AAmID,K,CAiDD;AACA;AACA;AACA;AACA;;;;;EA5UyBd,KAAK,CAACgE,a,GA+UjC;;;AACA,IAAMC,eAAe,GAAG,SAAlBA,eAAkB,CAACtB,KAAD;AAAA,SAA2B;AACjDb,IAAAA,YAAY,EAAErB,oBAAoB,CAACkC,KAAD;AADe,GAA3B;AAAA,CAAxB,C,CAIA;;;AACA,IAAMuB,kBAAkB,GAAG,SAArBA,kBAAqB,CAACC,QAAD,EAAkE;AAC3F,SAAO;AACL7B,IAAAA,eAAe,EAAEpC,kBAAkB,CAACC,mBAAmB,CAACmC,eAArB,EAAsC6B,QAAtC;AAD9B,GAAP;AAGD,CAJD,C,CAMA;;;AACA,IAAMC,qBAAqB,GAAGnE,OAAO,CAACgE,eAAD,EAAkBC,kBAAlB,CAAP,CAA6C9C,YAA7C,CAA9B;AACA,eAAegD,qBAAf","sourcesContent":["import { Radio, Dropdown, DropdownToggle, Checkbox, Tooltip, TooltipPosition } from '@patternfly/react-core';\nimport * as React from 'react';\nimport { connect } from 'react-redux';\nimport { ThunkDispatch } from 'redux-thunk';\nimport { bindActionCreators } from 'redux';\nimport { KialiAppState } from '../../../store/Store';\nimport { GraphToolbarActions } from '../../../actions/GraphToolbarActions';\nimport { TrafficRate, isGrpcRate, isHttpRate, isTcpRate } from '../../../types/Graph';\nimport { KialiAppAction } from 'actions/KialiAppAction';\nimport * as _ from 'lodash';\nimport { trafficRatesSelector } from 'store/Selectors';\nimport {\n  BoundingClientAwareComponent,\n  PropertyType\n} from 'components/BoundingClientAwareComponent/BoundingClientAwareComponent';\nimport { KialiIcon } from 'config/KialiIcon';\nimport {\n  containerStyle,\n  infoStyle,\n  itemStyleWithInfo,\n  itemStyleWithoutInfo,\n  menuStyle,\n  menuEntryStyle\n} from 'styles/DropdownStyles';\n\ntype ReduxProps = {\n  trafficRates: TrafficRate[];\n  setTrafficRates: (trafficRates: TrafficRate[]) => void;\n};\n\ntype GraphTrafficProps = ReduxProps & {\n  disabled: boolean;\n};\n\ntype GraphTrafficState = { isOpen: boolean };\n\ninterface TrafficRateOptionType {\n  id: string;\n  disabled?: boolean;\n  labelText: string;\n  isChecked: boolean;\n  onChange?: () => void;\n  tooltip?: React.ReactNode;\n}\n\nconst marginBottom = 20;\n\nclass GraphTraffic extends React.PureComponent<GraphTrafficProps, GraphTrafficState> {\n  constructor(props: GraphTrafficProps) {\n    super(props);\n    this.state = {\n      isOpen: false\n    };\n  }\n\n  private onToggle = isOpen => {\n    this.setState({\n      isOpen\n    });\n  };\n\n  render() {\n    return (\n      <Dropdown\n        toggle={\n          <DropdownToggle id=\"graph-traffic-dropdown\" onToggle={this.onToggle}>\n            Traffic\n          </DropdownToggle>\n        }\n        disabled={this.props.disabled}\n        isOpen={this.state.isOpen}\n      >\n        {this.getPopoverContent()}\n      </Dropdown>\n    );\n  }\n\n  private getPopoverContent() {\n    const trafficRates = this.props.trafficRates;\n\n    const trafficRateOptions: TrafficRateOptionType[] = [\n      // {\n      //   id: TrafficRate.GRPC_GROUP,\n      //   labelText: _.startCase(TrafficRate.GRPC_GROUP),\n      //   isChecked: trafficRates.includes(TrafficRate.GRPC_GROUP),\n      //   tooltip: (\n      //     <div style={{ textAlign: 'left' }}>\n      //       Displays active gRPC Edges for the time period, using the selected gRPC rate. To see idle gRPC Edges enable\n      //       the \"Idle Edges\" Display menu option. Default: Requests.\n      //     </div>\n      //   )\n      // },\n      {\n        id: TrafficRate.HTTP_GROUP,\n        labelText: _.startCase(TrafficRate.HTTP_GROUP),\n        isChecked: trafficRates.includes(TrafficRate.HTTP_GROUP),\n        // tooltip: (\n        //   <div style={{ textAlign: 'left' }}>\n        //     Displays active HTTP Edges for the time period, using the selected HTTP rate. To see idle HTTP Edges enable\n        //     the \"Idle Edges\" Display menu option. Default: Requests.\n        //   </div>\n        // )\n      },\n      // {\n      //   id: TrafficRate.TCP_GROUP,\n      //   labelText: _.startCase(TrafficRate.TCP_GROUP),\n      //   isChecked: trafficRates.includes(TrafficRate.TCP_GROUP),\n      //   tooltip: (\n      //     <div style={{ textAlign: 'left' }}>\n      //       Displays active TCP Edges for the time period, using the selected TCP rate. To see inactive TCP Edges enable\n      //       the \"Idle Edges\" Display menu option. Default: Sent Bytes.\n      //     </div>\n      //   )\n      // }\n    ];\n\n    // const grpcOptions: TrafficRateOptionType[] = [\n    //   {\n    //     id: TrafficRate.GRPC_RECEIVED,\n    //     labelText: 'Received Messages',\n    //     isChecked: trafficRates.includes(TrafficRate.GRPC_RECEIVED),\n    //     tooltip: (\n    //       <div style={{ textAlign: 'left' }}>\n    //         Received (i.e. Response) message rate in messages-per-second (mps). Captures server streaming RPCs.\n    //       </div>\n    //     )\n    //   },\n    //   {\n    //     id: TrafficRate.GRPC_REQUEST,\n    //     labelText: 'Requests',\n    //     isChecked: trafficRates.includes(TrafficRate.GRPC_REQUEST),\n    //     tooltip: (\n    //       <div style={{ textAlign: 'left' }}>\n    //         Request message rate in requests-per-second (rps). Captures unary RPC, with status codes.\n    //       </div>\n    //     )\n    //   },\n    //   {\n    //     id: TrafficRate.GRPC_SENT,\n    //     labelText: 'Sent Messages',\n    //     isChecked: trafficRates.includes(TrafficRate.GRPC_SENT),\n    //     tooltip: (\n    //       <div style={{ textAlign: 'left' }}>\n    //         Sent (i.e. Request) message rate in messages-per-second (mps). Captures client streaming RPCs.\n    //       </div>\n    //     )\n    //   },\n    //   {\n    //     id: TrafficRate.GRPC_TOTAL,\n    //     labelText: 'Total Messages',\n    //     isChecked: trafficRates.includes(TrafficRate.GRPC_TOTAL),\n    //     tooltip: (\n    //       <div style={{ textAlign: 'left' }}>\n    //         Combined (Sent + Received) message rate in messages-per-second (mps). Captures all streaming RPCs.\n    //       </div>\n    //     )\n    //   }\n    // ];\n\n    const httpOptions: TrafficRateOptionType[] = [\n      {\n        id: TrafficRate.HTTP_REQUEST,\n        labelText: 'Requests',\n        isChecked: trafficRates.includes(TrafficRate.HTTP_REQUEST),\n        // tooltip: (\n        //   <div style={{ textAlign: 'left' }}>\n        //     Request message rate in requests-per-second (rps). Captures status codes.\n        //   </div>\n        // )\n      }\n    ];\n\n    // const tcpOptions: TrafficRateOptionType[] = [\n    //   {\n    //     id: TrafficRate.TCP_RECEIVED,\n    //     labelText: 'Received Bytes',\n    //     isChecked: trafficRates.includes(TrafficRate.TCP_RECEIVED),\n    //     tooltip: <div style={{ textAlign: 'left' }}>Received bytes rate in bytes-per-second (bps).</div>\n    //   },\n    //   {\n    //     id: TrafficRate.TCP_SENT,\n    //     labelText: 'Sent Bytes',\n    //     isChecked: trafficRates.includes(TrafficRate.TCP_SENT),\n    //     tooltip: <div style={{ textAlign: 'left' }}>Sent bytes rate in bytes-per-second (bps).</div>\n    //   },\n    //   {\n    //     id: TrafficRate.TCP_TOTAL,\n    //     labelText: 'Total Bytes',\n    //     isChecked: trafficRates.includes(TrafficRate.TCP_TOTAL),\n    //     tooltip: (\n    //       <div style={{ textAlign: 'left' }}>Combined (Sent + Received) byte rate in bytes-per-second (mps).</div>\n    //     )\n    //   }\n    // ];\n\n    return (\n      <BoundingClientAwareComponent\n        className={containerStyle}\n        maxHeight={{ type: PropertyType.VIEWPORT_HEIGHT_MINUS_TOP, margin: marginBottom }}\n      >\n        <div id=\"graph-traffic-menu\" className={menuStyle} style={{ width: '16.5em' }}>\n          {trafficRateOptions.map((trafficRateOption: TrafficRateOptionType) => (\n            <div key={trafficRateOption.id} className={menuEntryStyle}>\n              <label\n                key={trafficRateOption.id}\n                className={!!trafficRateOption.tooltip ? itemStyleWithInfo : itemStyleWithoutInfo}\n              >\n                <Checkbox\n                  id={trafficRateOption.id}\n                  name=\"trafficRateOptions\"\n                  isChecked={trafficRateOption.isChecked}\n                  label={trafficRateOption.labelText}\n                  onChange={this.toggleTrafficRate}\n                  value={trafficRateOption.id}\n                />\n              </label>\n              {!!trafficRateOption.tooltip && (\n                <Tooltip\n                  key={`tooltip_${trafficRateOption.id}`}\n                  position={TooltipPosition.right}\n                  content={trafficRateOption.tooltip}\n                >\n                  <KialiIcon.Info className={infoStyle} />\n                </Tooltip>\n              )}\n              {/* {trafficRateOption.id === TrafficRate.GRPC_GROUP && grpcOptions.some(o => o.isChecked) && (\n                <div>\n                  {grpcOptions.map((grpcOption: TrafficRateOptionType) => (\n                    <div key={grpcOption.id} className={menuEntryStyle}>\n                      <label\n                        key={grpcOption.id}\n                        className={!!grpcOption.tooltip ? itemStyleWithInfo : itemStyleWithoutInfo}\n                        style={{ paddingLeft: '35px' }}\n                      >\n                        <Radio\n                          id={grpcOption.id}\n                          style={{ paddingLeft: '5px' }}\n                          name=\"grpcOptions\"\n                          isChecked={grpcOption.isChecked}\n                          label={grpcOption.labelText}\n                          onChange={this.toggleTrafficRateGrpc}\n                          value={grpcOption.id}\n                        />\n                      </label>\n                      {!!grpcOption.tooltip && (\n                        <Tooltip\n                          key={`tooltip_${grpcOption.id}`}\n                          position={TooltipPosition.right}\n                          content={grpcOption.tooltip}\n                        >\n                          <KialiIcon.Info className={infoStyle} />\n                        </Tooltip>\n                      )}\n                    </div>\n                  ))}\n                </div>\n              )} */}\n              {trafficRateOption.id === TrafficRate.HTTP_GROUP && httpOptions.some(o => o.isChecked) && (\n                <div>\n                  {httpOptions.map((httpOption: TrafficRateOptionType) => (\n                    <div key={httpOption.id} className={menuEntryStyle}>\n                      <label\n                        key={httpOption.id}\n                        className={!!httpOption.tooltip ? itemStyleWithInfo : itemStyleWithoutInfo}\n                        style={{ paddingLeft: '35px' }}\n                      >\n                        <Radio\n                          id={httpOption.id}\n                          style={{ paddingLeft: '5px' }}\n                          name=\"httpOptions\"\n                          isChecked={httpOption.isChecked}\n                          label={httpOption.labelText}\n                          onChange={this.toggleTrafficRateHttp}\n                          value={httpOption.id}\n                        />\n                      </label>\n                      {!!httpOption.tooltip && (\n                        <Tooltip\n                          key={`tooltip_${httpOption.id}`}\n                          position={TooltipPosition.right}\n                          content={httpOption.tooltip}\n                        >\n                          <KialiIcon.Info className={infoStyle} />\n                        </Tooltip>\n                      )}\n                    </div>\n                  ))}\n                </div>\n              )}\n              {/* {trafficRateOption.id === TrafficRate.TCP_GROUP && tcpOptions.some(o => o.isChecked) && (\n                <div>\n                  {tcpOptions.map((tcpOption: TrafficRateOptionType) => (\n                    <div key={tcpOption.id} className={menuEntryStyle}>\n                      <label\n                        key={tcpOption.id}\n                        className={!!tcpOption.tooltip ? itemStyleWithInfo : itemStyleWithoutInfo}\n                        style={{ paddingLeft: '35px' }}\n                      >\n                        <Radio\n                          id={tcpOption.id}\n                          style={{ paddingLeft: '5px' }}\n                          name=\"tcpOptions\"\n                          isChecked={tcpOption.isChecked}\n                          label={tcpOption.labelText}\n                          onChange={this.toggleTrafficRateTcp}\n                          value={tcpOption.id}\n                        />\n                      </label>\n                      {!!tcpOption.tooltip && (\n                        <Tooltip\n                          key={`tooltip_${tcpOption.id}`}\n                          position={TooltipPosition.right}\n                          content={tcpOption.tooltip}\n                        >\n                          <KialiIcon.Info className={infoStyle} />\n                        </Tooltip>\n                      )}\n                    </div>\n                  ))}\n                </div>\n              )} */}\n            </div>\n          ))}\n        </div>\n      </BoundingClientAwareComponent>\n    );\n  }\n\n  private toggleTrafficRate = (_, event) => {\n    const rate = event.target.value as TrafficRate;\n    if (this.props.trafficRates.includes(rate)) {\n      let newRates;\n      switch (rate) {\n        case TrafficRate.GRPC_GROUP:\n          newRates = this.props.trafficRates.filter(r => !isGrpcRate(r));\n          break;\n        case TrafficRate.HTTP_GROUP:\n          newRates = this.props.trafficRates.filter(r => !isHttpRate(r));\n          break;\n        case TrafficRate.TCP_GROUP:\n          newRates = this.props.trafficRates.filter(r => !isTcpRate(r));\n          break;\n        default:\n          newRates = this.props.trafficRates.filter(r => r !== rate);\n      }\n      this.props.setTrafficRates(newRates);\n    } else {\n      switch (rate) {\n        case TrafficRate.GRPC_GROUP:\n          this.props.setTrafficRates([...this.props.trafficRates, rate, TrafficRate.GRPC_REQUEST]);\n          break;\n        case TrafficRate.HTTP_GROUP:\n          this.props.setTrafficRates([...this.props.trafficRates, rate, TrafficRate.HTTP_REQUEST]);\n          break;\n        case TrafficRate.TCP_GROUP:\n          this.props.setTrafficRates([...this.props.trafficRates, rate, TrafficRate.TCP_SENT]);\n          break;\n        default:\n          this.props.setTrafficRates([...this.props.trafficRates, rate]);\n      }\n    }\n  };\n\n  // private toggleTrafficRateGrpc = (_, event) => {\n  //   const rate = event.target.value as TrafficRate;\n  //   const newRates = this.props.trafficRates.filter(r => !isGrpcRate(r));\n  //   this.props.setTrafficRates([...newRates, TrafficRate.GRPC_GROUP, rate]);\n  // };\n\n  private toggleTrafficRateHttp = (_, event) => {\n    const rate = event.target.value as TrafficRate;\n    const newRates = this.props.trafficRates.filter(r => !isHttpRate(r));\n    this.props.setTrafficRates([...newRates, TrafficRate.HTTP_GROUP, rate]);\n  };\n\n  // private toggleTrafficRateTcp = (_, event) => {\n  //   const rate = event.target.value as TrafficRate;\n  //   const newRates = this.props.trafficRates.filter(r => !isTcpRate(r));\n  //   this.props.setTrafficRates([...newRates, TrafficRate.TCP_GROUP, rate]);\n  // };\n}\n\n// Allow Redux to map sections of our global app state to our props\nconst mapStateToProps = (state: KialiAppState) => ({\n  trafficRates: trafficRatesSelector(state)\n});\n\n// Map our actions to Redux\nconst mapDispatchToProps = (dispatch: ThunkDispatch<KialiAppState, void, KialiAppAction>) => {\n  return {\n    setTrafficRates: bindActionCreators(GraphToolbarActions.setTrafficRates, dispatch)\n  };\n};\n\n// hook up to Redux for our State to be mapped to props\nconst GraphTrafficContainer = connect(mapStateToProps, mapDispatchToProps)(GraphTraffic);\nexport default GraphTrafficContainer;\n"]},"metadata":{},"sourceType":"module"}