{"ast":null,"code":"import _slicedToArray from \"/root/kiali-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _createForOfIteratorHelper from \"/root/kiali-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\nimport _classCallCheck from \"/root/kiali-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/root/kiali-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/root/kiali-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/root/kiali-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/root/kiali-ui/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nvar _jsxFileName = \"/root/kiali-ui/src/pages/extensions/iter8/metrics/Metrics.tsx\";\nimport * as React from 'react';\nimport * as FilterHelper from '../../../../components/FilterList/FilterHelper';\nimport { RenderContent } from '../../../../components/Nav/Page';\nimport * as ExpListFilters from '../Iter8ExperimentList/FiltersAndSorts';\nimport { style } from 'typestyle';\nimport { cellWidth, sortable, SortByDirection, Table, TableBody, TableHeader } from '@patternfly/react-table';\nimport { PromisesRegistry } from '../../../../utils/CancelablePromises';\nimport * as API from '../../../../services/Api';\nimport * as AlertUtils from '../../../../utils/AlertUtils';\nimport * as Iter8ExperimentListFilters from '../Iter8ExperimentList/FiltersAndSorts';\nimport { FilterSelected, StatefulFilters } from '../../../../components/Filters/StatefulFilters';\nimport { namespaceEquals } from '../../../../utils/Common';\nimport history from '../../../../app/History';\nimport { Dropdown, DropdownItem, DropdownPosition, DropdownToggle, EmptyState, EmptyStateBody, EmptyStateVariant, PopoverPosition, Text, TextContent, TextVariants, Title, Tooltip, TooltipPosition } from '@patternfly/react-core';\nimport { PFColors } from '../../../../components/Pf/PfColors';\nimport { KialiIcon } from '../../../../config/KialiIcon';\nimport { OkIcon, PowerOffIcon } from '@patternfly/react-icons';\nimport { Link } from 'react-router-dom';\nimport { activeNamespacesSelector, durationSelector } from '../../../../store/Selectors';\nimport { connect } from 'react-redux';\nimport DefaultSecondaryMasthead from '../../../../components/DefaultSecondaryMasthead/DefaultSecondaryMasthead';\nimport RefreshContainer from '../../../../components/Refresh/Refresh';\nimport { PFBadges, PFBadge } from 'components/Pf/PfBadges'; // iframe Url\n\nvar metrics_url = \"http://metric.ingress.isa.buaanlsde.cn/d/eXPEaNnZz/experiment-metrics?orgId=1&refresh=10s&kiosk=tv\"; // Style constants\n\nvar containerPadding = style({\n  padding: '20px 20px 20px 20px'\n});\nvar greenIconStyle = style({\n  fontSize: '1.0em',\n  color: 'green'\n});\nvar redIconStyle = style({\n  fontSize: '1.0em',\n  color: 'red'\n});\nvar statusIconStyle = style({\n  fontSize: '1.0em'\n});\nvar columns = [{\n  title: '实验名称',\n  transforms: [sortable]\n}, {\n  title: '命名空间',\n  transforms: [sortable]\n}, {\n  title: '目标服务',\n  transforms: [sortable]\n}, {\n  title: '阶段',\n  transforms: [sortable, cellWidth(5)]\n}, {\n  title: '基准服务',\n  transforms: [sortable]\n}, {\n  title: '候选服务',\n  transforms: [sortable]\n}];\n\nvar ExperimentListPageComponent = /*#__PURE__*/function (_React$Component) {\n  _inherits(ExperimentListPageComponent, _React$Component);\n\n  var _super = _createSuper(ExperimentListPageComponent);\n\n  function ExperimentListPageComponent(props) {\n    var _this;\n\n    _classCallCheck(this, ExperimentListPageComponent);\n\n    _this = _super.call(this, props);\n    _this.promises = new PromisesRegistry();\n\n    _this.fetchExperiments = function (namespaces) {\n      API.getIter8Info().then(function (result) {\n        var iter8Info = result.data;\n\n        if (iter8Info.enabled) {\n          if (!iter8Info.supportedVersion) {\n            if (iter8Info.analyticsImgVersion !== '' && iter8Info.analyticsImgVersion.startsWith('2')) {\n              AlertUtils.addError('Iter8 v' + iter8Info.analyticsImgVersion + ' is not supported, please use the supported version (v1.x).');\n              return;\n            }\n\n            AlertUtils.addError('You are running an unsupported Iter8 version, please upgrade to supported version  (v0.2+) to take advantage of the full features of Iter8 .');\n            return;\n          }\n\n          if (namespaces.length > 0) {\n            API.getExperiments(namespaces).then(function (result) {\n              _this.setState(function (prevState) {\n                return {\n                  iter8Info: iter8Info,\n                  experimentLists: Iter8ExperimentListFilters.filterBy(result.data, FilterSelected.getSelected()),\n                  sortBy: prevState.sortBy\n                };\n              });\n            }).catch(function (error) {\n              AlertUtils.addError('Could not fetch Iter8 Experiments.', error);\n            });\n          }\n        } else {\n          AlertUtils.addError('Kiali has Iter8 extension enabled but it is not detected in the cluster under namespace ' + iter8Info.namespace);\n        }\n      }).catch(function (error) {\n        AlertUtils.addError('Could not fetch Iter8 Info.', error);\n      });\n    };\n\n    _this.paramsAreSynced = function (prevProps) {\n      var activeNamespacesCompare = namespaceEquals(prevProps.activeNamespaces, _this.props.activeNamespaces);\n      var paramsSynced = activeNamespacesCompare;\n      return [paramsSynced, activeNamespacesCompare];\n    };\n\n    _this.onSort = function (_event, index, direction) {\n      var experimentList = _this.state.experimentLists.sort(function (a, b) {\n        switch (index) {\n          case 0:\n            return a.name < b.name ? -1 : a.name > b.name ? 1 : 0;\n\n          case 1:\n            return a.namespace < b.namespace ? -1 : a.namespace > b.namespace ? 1 : 0;\n\n          case 2:\n            return a.phase < b.phase ? -1 : a.phase > b.phase ? 1 : 0;\n\n          case 3:\n            return a.status < b.status ? -1 : a.status > b.status ? 1 : 0;\n\n          case 4:\n            return a.baseline < b.baseline ? -1 : a.baseline > b.baseline ? 1 : 0;\n        }\n\n        return 0;\n      });\n\n      _this.setState({\n        experimentLists: direction === SortByDirection.asc ? experimentList : experimentList.reverse(),\n        sortBy: {\n          index: index,\n          direction: direction\n        }\n      });\n    };\n\n    _this.updateListItems = function () {\n      _this.promises.cancelAll();\n\n      var namespacesSelected = _this.props.activeNamespaces.map(function (item) {\n        return item.name;\n      });\n\n      if (namespacesSelected.length !== 0) {\n        _this.fetchExperiments(namespacesSelected);\n      } else {\n        _this.setState({\n          experimentLists: []\n        });\n      }\n    };\n\n    _this.goNewExperimentPage = function () {\n      history.push('/extensions/iter8/new');\n    };\n\n    _this.goNewExperimentFromFile = function () {\n      history.push('/extensions/iter8/newfromfile');\n    };\n\n    _this.actionsToolbar = function () {\n      return /*#__PURE__*/React.createElement(Dropdown, {\n        id: \"actions\",\n        title: \"\\u521B\\u5EFA\\u65B0\\u5B9E\\u9A8C\",\n        toggle: /*#__PURE__*/React.createElement(DropdownToggle, {\n          onToggle: function onToggle(toggle) {\n            return _this.setState({\n              dropdownOpen: toggle\n            });\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 260,\n            columnNumber: 17\n          }\n        }, \"\\u521B\\u5EFA\\u65B0\\u5B9E\\u9A8C\"),\n        onSelect: function onSelect() {\n          return _this.setState({\n            dropdownOpen: !_this.state.dropdownOpen\n          });\n        },\n        position: DropdownPosition.right,\n        isOpen: _this.state.dropdownOpen,\n        dropdownItems: [/*#__PURE__*/React.createElement(DropdownItem, {\n          key: \"createExperiment\",\n          isDisabled: !_this.state.iter8Info.enabled,\n          onClick: function onClick() {\n            return _this.goNewExperimentPage();\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 265,\n            columnNumber: 11\n          }\n        }, \"\\u624B\\u52A8\\u521B\\u5EFA\\u65B0\\u5B9E\\u9A8C\"), /*#__PURE__*/React.createElement(DropdownItem, {\n          key: \"createExperimentFromFile\",\n          isDisabled: !_this.state.iter8Info.enabled,\n          onClick: function onClick() {\n            return _this.goNewExperimentFromFile();\n          },\n          __self: _assertThisInitialized(_this),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 272,\n            columnNumber: 11\n          }\n        }, \"\\u5BFC\\u5165\\u914D\\u7F6E\\u6587\\u4EF6\\u521B\\u5EFA\\u65B0\\u5B9E\\u9A8C\")],\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 7\n        }\n      });\n    };\n\n    _this.onFilterChange = function () {\n      // Resetting pagination when filters change\n      _this.updateListItems();\n    };\n\n    _this.toolbar = function () {\n      return /*#__PURE__*/React.createElement(StatefulFilters, {\n        initialFilters: Iter8ExperimentListFilters.availableFilters,\n        onFilterChange: _this.onFilterChange,\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 291,\n          columnNumber: 7\n        }\n      });\n    };\n\n    _this.getStatusTooltip = function (phase, status, winnerFound, winnerName, baselineName) {\n      var statusValue = '实验状态: 正在进行';\n      var retStatus = status;\n\n      if (status.length > 0) {\n        var values = status.split(':');\n\n        if (values.length > 1) {\n          retStatus = values.slice(1)[0];\n        }\n\n        if (status.includes('Failed')) {\n          statusValue = '实验状态: 失败';\n        } else if (status.includes('Completed')) {\n          statusValue = '实验状态: 成功';\n\n          if (winnerName === baselineName) {\n            retStatus = '流量切换回基准版本';\n          }\n        }\n      }\n\n      return /*#__PURE__*/React.createElement(TextContent, {\n        style: {\n          color: PFColors.White\n        },\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 322,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(Text, {\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 323,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"h2\", {\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 324,\n          columnNumber: 11\n        }\n      }, \"\\u5F53\\u524D\\u9636\\u6BB5: \"), \" \", phase), /*#__PURE__*/React.createElement(Text, {\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 326,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"h2\", {\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 327,\n          columnNumber: 11\n        }\n      }, statusValue), \" \", retStatus), /*#__PURE__*/React.createElement(Text, {\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 329,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"h2\", {\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 330,\n          columnNumber: 11\n        }\n      }, \"\\u83B7\\u80DC\\u7248\\u672C: \", winnerFound ? winnerName : '未找到'), /*#__PURE__*/React.createElement(Text, {\n        component: TextVariants.p,\n        __self: _assertThisInitialized(_this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 331,\n          columnNumber: 11\n        }\n      }, \"(\\u901A\\u8FC7\\u6301\\u7EED\\u90E8\\u7F72\\u667A\\u80FD\\u51B3\\u7B56\\u5B9E\\u9A8C\\u5F97\\u5230\\u7684\\u670D\\u52A1\\u83B7\\u80DC\\u7248\\u672C)\")));\n    };\n\n    _this.experimentStatusIcon = function (key, phase, winnerStatus, status, baselineName) {\n      var className = greenIconStyle;\n      var toBaseline = false;\n\n      var statusString = _this.getStatusTooltip(phase, status, winnerStatus.winning_version_found, winnerStatus.name, baselineName);\n\n      if (status.includes('Abort')) {\n        className = greenIconStyle;\n      } else if (!winnerStatus.winning_version_found) {\n        className = redIconStyle;\n      }\n\n      if (winnerStatus.name === baselineName) {\n        toBaseline = true;\n        className = redIconStyle;\n      }\n\n      switch (phase) {\n        case 'Initializing':\n          return /*#__PURE__*/React.createElement(Tooltip, {\n            key: 'Initializing_' + key,\n            \"aria-label\": 'Status indicator',\n            position: PopoverPosition.auto,\n            className: 'health_indicator',\n            content: /*#__PURE__*/React.createElement(React.Fragment, null, statusString),\n            __self: _assertThisInitialized(_this),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 360,\n              columnNumber: 11\n            }\n          }, /*#__PURE__*/React.createElement(KialiIcon.InProgressIcon, {\n            className: statusIconStyle,\n            __self: _assertThisInitialized(_this),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 367,\n              columnNumber: 13\n            }\n          }));\n\n        case 'Progressing':\n          return /*#__PURE__*/React.createElement(Tooltip, {\n            key: 'Progressing_' + key,\n            \"aria-label\": 'Status indicator',\n            position: PopoverPosition.auto,\n            className: 'health_indicator',\n            content: /*#__PURE__*/React.createElement(React.Fragment, null, statusString),\n            __self: _assertThisInitialized(_this),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 372,\n              columnNumber: 11\n            }\n          }, /*#__PURE__*/React.createElement(KialiIcon.OnRunningIcon, {\n            className: statusIconStyle,\n            __self: _assertThisInitialized(_this),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 379,\n              columnNumber: 13\n            }\n          }));\n\n        case 'Pause':\n          return /*#__PURE__*/React.createElement(Tooltip, {\n            key: 'Pause_' + key,\n            \"aria-label\": 'Status indicator',\n            position: PopoverPosition.auto,\n            className: 'health_indicator',\n            content: /*#__PURE__*/React.createElement(React.Fragment, null, statusString),\n            __self: _assertThisInitialized(_this),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 384,\n              columnNumber: 11\n            }\n          }, /*#__PURE__*/React.createElement(KialiIcon.PauseCircle, {\n            className: statusIconStyle,\n            __self: _assertThisInitialized(_this),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 391,\n              columnNumber: 13\n            }\n          }));\n\n        case 'Completed':\n          if (status.includes('Abort')) {\n            return /*#__PURE__*/React.createElement(Tooltip, {\n              key: 'Completed_' + key,\n              \"aria-label\": 'Status indicator',\n              position: PopoverPosition.auto,\n              className: 'health_indicator',\n              content: /*#__PURE__*/React.createElement(React.Fragment, null, statusString),\n              __self: _assertThisInitialized(_this),\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 397,\n                columnNumber: 13\n              }\n            }, /*#__PURE__*/React.createElement(PowerOffIcon, {\n              className: className,\n              __self: _assertThisInitialized(_this),\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 404,\n                columnNumber: 15\n              }\n            }));\n          } else if (toBaseline) {\n            return /*#__PURE__*/React.createElement(Tooltip, {\n              key: 'Completed_' + key,\n              \"aria-label\": 'Status indicator',\n              position: PopoverPosition.auto,\n              className: 'health_indicator',\n              content: /*#__PURE__*/React.createElement(React.Fragment, null, statusString),\n              __self: _assertThisInitialized(_this),\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 409,\n                columnNumber: 13\n              }\n            }, /*#__PURE__*/React.createElement(OkIcon, {\n              className: className,\n              __self: _assertThisInitialized(_this),\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 416,\n                columnNumber: 15\n              }\n            }));\n          }\n\n          return /*#__PURE__*/React.createElement(Tooltip, {\n            key: 'Completed_' + key,\n            \"aria-label\": 'Status indicator',\n            position: PopoverPosition.auto,\n            className: 'health_indicator',\n            content: /*#__PURE__*/React.createElement(React.Fragment, null, statusString),\n            __self: _assertThisInitialized(_this),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 421,\n              columnNumber: 11\n            }\n          }, /*#__PURE__*/React.createElement(OkIcon, {\n            className: className,\n            __self: _assertThisInitialized(_this),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 428,\n              columnNumber: 13\n            }\n          }));\n\n        default:\n          return /*#__PURE__*/React.createElement(Tooltip, {\n            key: 'default_' + key,\n            \"aria-label\": 'Status indicator',\n            position: PopoverPosition.auto,\n            className: 'health_indicator',\n            content: /*#__PURE__*/React.createElement(React.Fragment, null, statusString),\n            __self: _assertThisInitialized(_this),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 433,\n              columnNumber: 11\n            }\n          }, /*#__PURE__*/React.createElement(KialiIcon.OnRunningIcon, {\n            className: statusIconStyle,\n            __self: _assertThisInitialized(_this),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 440,\n              columnNumber: 13\n            }\n          }));\n      }\n    };\n\n    _this.rows = function () {\n      return _this.state.experimentLists.map(function (h) {\n        var candidates = [];\n\n        var _iterator = _createForOfIteratorHelper(h.candidates),\n            _step;\n\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var c = _step.value;\n            candidates.push(c.name);\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n\n        return {\n          cells: [/*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(PFBadge, {\n            key: \"TooltipExtensionIter8Name_\".concat(h.name),\n            badge: PFBadges.Iter8,\n            position: TooltipPosition.top,\n            __self: _assertThisInitialized(_this),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 481,\n              columnNumber: 13\n            }\n          }), /*#__PURE__*/React.createElement(PFBadge, {\n            badge: {\n              badge: h.experimentKind\n            },\n            __self: _assertThisInitialized(_this),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 486,\n              columnNumber: 13\n            }\n          }), /*#__PURE__*/React.createElement(Link, {\n            to: \"/extensions/namespaces/\".concat(h.namespace, \"/iter8/\").concat(h.name, \"?target=\").concat(h.targetService, \"&startTime=\").concat(h.startTime, \"&endTime=\").concat(h.endTime, \"&baseline=\").concat(h.baseline.name, \"&candidates=\").concat(candidates),\n            key: 'Experiment_' + h.namespace + '_' + h.namespace,\n            __self: _assertThisInitialized(_this),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 487,\n              columnNumber: 13\n            }\n          }, h.name)), /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(PFBadge, {\n            key: \"TooltipExtensionNamespace_\".concat(h.namespace),\n            badge: PFBadges.Namespace,\n            position: TooltipPosition.top,\n            __self: _assertThisInitialized(_this),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 495,\n              columnNumber: 13\n            }\n          }), h.namespace), /*#__PURE__*/React.createElement(React.Fragment, null, h.kind === 'Deployment' ? _this.redirectLink(h.namespace, h.targetService, 'Service') : _this.redirectLink(h.namespace, '', h.kind)), /*#__PURE__*/React.createElement(React.Fragment, null, _this.experimentStatusIcon(h.name + '_' + h.namespace, h.phase, h.winner, h.status, h.baseline.name)), /*#__PURE__*/React.createElement(React.Fragment, null, _this.redirectLink(h.namespace, h.baseline.name, h.kind), /*#__PURE__*/React.createElement(\"br\", {\n            __self: _assertThisInitialized(_this),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 511,\n              columnNumber: 13\n            }\n          }), \" \", h.baseline.weight, \"%\"), /*#__PURE__*/React.createElement(React.Fragment, null, h.candidates.map(function (can) {\n            return /*#__PURE__*/React.createElement(React.Fragment, null, _this.redirectLink(h.namespace, can.name, h.kind), \"\\xA0\", can.weight, \"% \", /*#__PURE__*/React.createElement(\"br\", {\n              __self: _assertThisInitialized(_this),\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 518,\n                columnNumber: 39\n              }\n            }));\n          }))]\n        };\n      });\n    };\n\n    var prevCurrentSortField = FilterHelper.currentSortField(ExpListFilters.sortFields);\n    var prevIsSortAscending = FilterHelper.isCurrentSortAscending();\n    _this.state = {\n      iter8Info: {\n        enabled: false,\n        supportedVersion: false,\n        controllerImgVersion: '',\n        analyticsImgVersion: '',\n        namespace: 'iter8'\n      },\n      experimentLists: [],\n      sortBy: {},\n      dropdownOpen: false,\n      listItems: [],\n      currentSortField: prevCurrentSortField,\n      isSortAscending: prevIsSortAscending,\n      onFilterChange: false\n    };\n    return _this;\n  }\n\n  _createClass(ExperimentListPageComponent, [{\n    key: \"componentDidMount\",\n    value: // It invokes backend when component is mounted\n    function componentDidMount() {\n      this.updateListItems();\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps, _prevState, _snapshot) {\n      var _this$paramsAreSynced = this.paramsAreSynced(prevProps),\n          _this$paramsAreSynced2 = _slicedToArray(_this$paramsAreSynced, 1),\n          paramsSynced = _this$paramsAreSynced2[0];\n\n      if (!paramsSynced) {\n        this.setState({\n          currentSortField: this.props.currentSortField,\n          isSortAscending: this.props.isSortAscending\n        });\n        this.updateListItems();\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.promises.cancelAll();\n    }\n  }, {\n    key: \"redirectLink\",\n    value: function redirectLink(namespace, name, kind) {\n      if (kind === 'Deployment') {\n        var linkTo = '/namespaces/' + namespace + '/workloads/' + name;\n        return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(PFBadge, {\n          badge: {\n            badge: 'W'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 451,\n            columnNumber: 11\n          }\n        }), /*#__PURE__*/React.createElement(Link, {\n          to: linkTo,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 452,\n            columnNumber: 11\n          }\n        }, name));\n      } else {\n        if (name !== '') {\n          var _linkTo = '/namespaces/' + namespace + '/services/' + name;\n\n          return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(PFBadge, {\n            badge: {\n              badge: 'S'\n            },\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 460,\n              columnNumber: 13\n            }\n          }), /*#__PURE__*/React.createElement(Link, {\n            to: _linkTo,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 461,\n              columnNumber: 13\n            }\n          }, name));\n        } else {\n          return 'N/A';\n        }\n      }\n    } // Helper used to build the table content.\n\n  }, {\n    key: \"render\",\n    value: function render() {\n      return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          backgroundColor: '#fff'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 531,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(DefaultSecondaryMasthead, {\n        rightToolbar: /*#__PURE__*/React.createElement(RefreshContainer, {\n          id: \"exp_list_refresh\",\n          disabled: false,\n          hideLabel: true,\n          handleRefresh: this.updateListItems,\n          manageURL: true,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 534,\n            columnNumber: 15\n          }\n        }),\n        actionsToolbar: this.actionsToolbar(),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 532,\n          columnNumber: 11\n        }\n      })), /*#__PURE__*/React.createElement(RenderContent, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 545,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: containerPadding,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 546,\n          columnNumber: 11\n        }\n      }, this.toolbar(), /*#__PURE__*/React.createElement(Table, {\n        \"aria-label\": \"Sortable Table\",\n        sortBy: this.state.sortBy,\n        cells: columns,\n        rows: this.rows(),\n        onSort: this.onSort,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 548,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(TableHeader, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 555,\n          columnNumber: 15\n        }\n      }), this.state.experimentLists.length > 0 ? /*#__PURE__*/React.createElement(TableBody, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 557,\n          columnNumber: 17\n        }\n      }) : /*#__PURE__*/React.createElement(\"tr\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 559,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        colSpan: columns.length,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 560,\n          columnNumber: 19\n        }\n      }, this.props.activeNamespaces.length > 0 ? /*#__PURE__*/React.createElement(EmptyState, {\n        variant: EmptyStateVariant.full,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 562,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(Title, {\n        headingLevel: \"h5\",\n        size: \"lg\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 563,\n          columnNumber: 25\n        }\n      }, \"\\u672A\\u53D1\\u73B0\\u76F8\\u5173\\u5B9E\\u9A8C\"), /*#__PURE__*/React.createElement(EmptyStateBody, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 566,\n          columnNumber: 25\n        }\n      }, \"\\u547D\\u540D\\u7A7A\\u95F4\\uFF1A\", this.props.activeNamespaces.length === 1 ? \" \".concat(this.props.activeNamespaces[0].name) : \"s: \".concat(this.props.activeNamespaces.map(function (ns) {\n        return ns.name;\n      }).join(', ')), \" \\u4E0B\\u5C1A\\u672A\\u521B\\u5EFA\\u5B9E\\u9A8C\\u6216\\u5B9E\\u9A8C\\u5DF2\\u88AB\\u5220\\u9664\")) : /*#__PURE__*/React.createElement(EmptyState, {\n        variant: EmptyStateVariant.full,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 574,\n          columnNumber: 23\n        }\n      }, /*#__PURE__*/React.createElement(Title, {\n        headingLevel: \"h5\",\n        size: \"lg\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 575,\n          columnNumber: 25\n        }\n      }, \"\\u672A\\u9009\\u62E9\\u547D\\u540D\\u7A7A\\u95F4\"), /*#__PURE__*/React.createElement(EmptyStateBody, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 578,\n          columnNumber: 25\n        }\n      }, \"\\u8BF7\\u5148\\u9009\\u62E9\\u547D\\u540D\\u7A7A\\u95F4\\u6765\\u67E5\\u770B\\u5B9E\\u9A8C\"))))))));\n    }\n  }]);\n\n  return ExperimentListPageComponent;\n}(React.Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    activeNamespaces: activeNamespacesSelector(state),\n    duration: durationSelector(state)\n  };\n};\n\nvar Metrics = connect(mapStateToProps)(ExperimentListPageComponent);\nexport default Metrics;","map":{"version":3,"sources":["/root/kiali-ui/src/pages/extensions/iter8/metrics/Metrics.tsx"],"names":["React","FilterHelper","RenderContent","ExpListFilters","style","cellWidth","sortable","SortByDirection","Table","TableBody","TableHeader","PromisesRegistry","API","AlertUtils","Iter8ExperimentListFilters","FilterSelected","StatefulFilters","namespaceEquals","history","Dropdown","DropdownItem","DropdownPosition","DropdownToggle","EmptyState","EmptyStateBody","EmptyStateVariant","PopoverPosition","Text","TextContent","TextVariants","Title","Tooltip","TooltipPosition","PFColors","KialiIcon","OkIcon","PowerOffIcon","Link","activeNamespacesSelector","durationSelector","connect","DefaultSecondaryMasthead","RefreshContainer","PFBadges","PFBadge","metrics_url","containerPadding","padding","greenIconStyle","fontSize","color","redIconStyle","statusIconStyle","columns","title","transforms","ExperimentListPageComponent","props","promises","fetchExperiments","namespaces","getIter8Info","then","result","iter8Info","data","enabled","supportedVersion","analyticsImgVersion","startsWith","addError","length","getExperiments","setState","prevState","experimentLists","filterBy","getSelected","sortBy","catch","error","namespace","paramsAreSynced","prevProps","activeNamespacesCompare","activeNamespaces","paramsSynced","onSort","_event","index","direction","experimentList","state","sort","a","b","name","phase","status","baseline","asc","reverse","updateListItems","cancelAll","namespacesSelected","map","item","goNewExperimentPage","push","goNewExperimentFromFile","actionsToolbar","toggle","dropdownOpen","right","onFilterChange","toolbar","availableFilters","getStatusTooltip","winnerFound","winnerName","baselineName","statusValue","retStatus","values","split","slice","includes","White","p","experimentStatusIcon","key","winnerStatus","className","toBaseline","statusString","winning_version_found","auto","rows","h","candidates","c","cells","Iter8","top","badge","experimentKind","targetService","startTime","endTime","Namespace","kind","redirectLink","winner","weight","can","prevCurrentSortField","currentSortField","sortFields","prevIsSortAscending","isCurrentSortAscending","controllerImgVersion","listItems","isSortAscending","_prevState","_snapshot","linkTo","backgroundColor","full","ns","join","Component","mapStateToProps","duration","Metrics"],"mappings":"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","sourcesContent":["import * as React from 'react';\r\nimport * as FilterHelper from '../../../../components/FilterList/FilterHelper';\r\nimport { RenderContent } from '../../../../components/Nav/Page';\r\nimport * as ExpListFilters from '../Iter8ExperimentList/FiltersAndSorts';\r\nimport { style } from 'typestyle';\r\nimport * as FilterComponent from '../../../../components/FilterList/FilterComponent';\r\nimport { Iter8Experiment, Iter8Info, Winner } from '../../../../types/Iter8';\r\nimport Namespace from '../../../../types/Namespace';\r\nimport {\r\n  cellWidth,\r\n  IRow,\r\n  ISortBy,\r\n  sortable,\r\n  SortByDirection,\r\n  Table,\r\n  TableBody,\r\n  TableHeader\r\n} from '@patternfly/react-table';\r\nimport { PromisesRegistry } from '../../../../utils/CancelablePromises';\r\nimport * as API from '../../../../services/Api';\r\nimport * as AlertUtils from '../../../../utils/AlertUtils';\r\nimport * as Iter8ExperimentListFilters from '../Iter8ExperimentList/FiltersAndSorts';\r\nimport { FilterSelected, StatefulFilters } from '../../../../components/Filters/StatefulFilters';\r\nimport { namespaceEquals } from '../../../../utils/Common';\r\nimport history from '../../../../app/History';\r\nimport {\r\n  Dropdown,\r\n  DropdownItem,\r\n  DropdownPosition,\r\n  DropdownToggle,\r\n  EmptyState,\r\n  EmptyStateBody,\r\n  EmptyStateVariant,\r\n  PopoverPosition,\r\n  Text,\r\n  TextContent,\r\n  TextVariants,\r\n  Title,\r\n  Tooltip,\r\n  TooltipPosition\r\n} from '@patternfly/react-core';\r\nimport { PFColors } from '../../../../components/Pf/PfColors';\r\nimport { KialiIcon } from '../../../../config/KialiIcon';\r\nimport { OkIcon, PowerOffIcon } from '@patternfly/react-icons';\r\nimport { Link } from 'react-router-dom';\r\nimport { KialiAppState } from '../../../../store/Store';\r\nimport { activeNamespacesSelector, durationSelector } from '../../../../store/Selectors';\r\nimport { connect } from 'react-redux';\r\nimport DefaultSecondaryMasthead from '../../../../components/DefaultSecondaryMasthead/DefaultSecondaryMasthead';\r\nimport RefreshContainer from '../../../../components/Refresh/Refresh';\r\nimport { PFBadges, PFBadge } from 'components/Pf/PfBadges';\r\n\r\n// iframe Url\r\nvar metrics_url = \"http://metric.ingress.isa.buaanlsde.cn/d/eXPEaNnZz/experiment-metrics?orgId=1&refresh=10s&kiosk=tv\"\r\n\r\n// Style constants\r\nconst containerPadding = style({ padding: '20px 20px 20px 20px' });\r\nconst greenIconStyle = style({\r\n  fontSize: '1.0em',\r\n  color: 'green'\r\n});\r\nconst redIconStyle = style({\r\n  fontSize: '1.0em',\r\n  color: 'red'\r\n});\r\nconst statusIconStyle = style({\r\n  fontSize: '1.0em'\r\n});\r\n\r\ninterface Props extends FilterComponent.Props<Iter8Experiment> {\r\n  activeNamespaces: Namespace[];\r\n}\r\n\r\n// State of the component/page\r\n// It stores the visual state of the components and the experiments fetched from the backend.\r\ninterface State extends FilterComponent.State<Iter8Experiment> {\r\n  iter8Info: Iter8Info;\r\n  experimentLists: Iter8Experiment[];\r\n  sortBy: ISortBy;\r\n  dropdownOpen: boolean;\r\n  onFilterChange: boolean;\r\n}\r\n\r\nconst columns = [\r\n  {\r\n    title: '实验名称',\r\n    transforms: [sortable]\r\n  },\r\n  {\r\n    title: '命名空间',\r\n    transforms: [sortable]\r\n  },\r\n  {\r\n    title: '目标服务',\r\n    transforms: [sortable]\r\n  },\r\n  {\r\n    title: '阶段',\r\n    transforms: [sortable, cellWidth(5) as any]\r\n  },\r\n  {\r\n    title: '基准服务',\r\n    transforms: [sortable]\r\n  },\r\n  {\r\n    title: '候选服务',\r\n    transforms: [sortable]\r\n  }\r\n];\r\n\r\nclass ExperimentListPageComponent extends React.Component<Props, State> {\r\n  private promises = new PromisesRegistry();\r\n\r\n  constructor(props: Props) {\r\n    super(props);\r\n    const prevCurrentSortField = FilterHelper.currentSortField(ExpListFilters.sortFields);\r\n    const prevIsSortAscending = FilterHelper.isCurrentSortAscending();\r\n    this.state = {\r\n      iter8Info: {\r\n        enabled: false,\r\n        supportedVersion: false,\r\n        controllerImgVersion: '',\r\n        analyticsImgVersion: '',\r\n        namespace: 'iter8'\r\n      },\r\n      experimentLists: [],\r\n      sortBy: {},\r\n      dropdownOpen: false,\r\n      listItems: [],\r\n      currentSortField: prevCurrentSortField,\r\n      isSortAscending: prevIsSortAscending,\r\n      onFilterChange: false\r\n    };\r\n  }\r\n\r\n  fetchExperiments = (namespaces: string[]) => {\r\n    API.getIter8Info()\r\n      .then(result => {\r\n        const iter8Info = result.data;\r\n        if (iter8Info.enabled) {\r\n          if (!iter8Info.supportedVersion) {\r\n            if (iter8Info.analyticsImgVersion !== '' && iter8Info.analyticsImgVersion.startsWith('2')) {\r\n              AlertUtils.addError(\r\n                'Iter8 v' +\r\n                  iter8Info.analyticsImgVersion +\r\n                  ' is not supported, please use the supported version (v1.x).'\r\n              );\r\n              return;\r\n            }\r\n            AlertUtils.addError(\r\n              'You are running an unsupported Iter8 version, please upgrade to supported version  (v0.2+) to take advantage of the full features of Iter8 .'\r\n            );\r\n            return;\r\n          }\r\n          if (namespaces.length > 0) {\r\n            API.getExperiments(namespaces)\r\n              .then(result => {\r\n                this.setState(prevState => {\r\n                  return {\r\n                    iter8Info: iter8Info,\r\n                    experimentLists: Iter8ExperimentListFilters.filterBy(result.data, FilterSelected.getSelected()),\r\n                    sortBy: prevState.sortBy\r\n                  };\r\n                });\r\n              })\r\n              .catch(error => {\r\n                AlertUtils.addError('Could not fetch Iter8 Experiments.', error);\r\n              });\r\n          }\r\n        } else {\r\n          AlertUtils.addError(\r\n            'Kiali has Iter8 extension enabled but it is not detected in the cluster under namespace ' +\r\n              iter8Info.namespace\r\n          );\r\n        }\r\n      })\r\n      .catch(error => {\r\n        AlertUtils.addError('Could not fetch Iter8 Info.', error);\r\n      });\r\n  };\r\n\r\n  // It invokes backend when component is mounted\r\n  componentDidMount() {\r\n    this.updateListItems();\r\n  }\r\n\r\n  componentDidUpdate(prevProps: Props, _prevState: State, _snapshot: any) {\r\n    const [paramsSynced] = this.paramsAreSynced(prevProps);\r\n    if (!paramsSynced) {\r\n      this.setState({\r\n        currentSortField: this.props.currentSortField,\r\n        isSortAscending: this.props.isSortAscending\r\n      });\r\n\r\n      this.updateListItems();\r\n    }\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.promises.cancelAll();\r\n  }\r\n\r\n  paramsAreSynced = (prevProps: Props): [boolean, boolean] => {\r\n    const activeNamespacesCompare = namespaceEquals(prevProps.activeNamespaces, this.props.activeNamespaces);\r\n    const paramsSynced = activeNamespacesCompare;\r\n    return [paramsSynced, activeNamespacesCompare];\r\n  };\r\n\r\n  // Helper used for Table to sort handlers based on index column == field\r\n  onSort = (_event, index, direction) => {\r\n    const experimentList = this.state.experimentLists.sort((a, b) => {\r\n      switch (index) {\r\n        case 0:\r\n          return a.name < b.name ? -1 : a.name > b.name ? 1 : 0;\r\n        case 1:\r\n          return a.namespace < b.namespace ? -1 : a.namespace > b.namespace ? 1 : 0;\r\n        case 2:\r\n          return a.phase < b.phase ? -1 : a.phase > b.phase ? 1 : 0;\r\n        case 3:\r\n          return a.status < b.status ? -1 : a.status > b.status ? 1 : 0;\r\n        case 4:\r\n          return a.baseline < b.baseline ? -1 : a.baseline > b.baseline ? 1 : 0;\r\n      }\r\n      return 0;\r\n    });\r\n    this.setState({\r\n      experimentLists: direction === SortByDirection.asc ? experimentList : experimentList.reverse(),\r\n      sortBy: {\r\n        index,\r\n        direction\r\n      }\r\n    });\r\n  };\r\n\r\n  updateListItems = () => {\r\n    this.promises.cancelAll();\r\n    const namespacesSelected = this.props.activeNamespaces.map(item => item.name);\r\n    if (namespacesSelected.length !== 0) {\r\n      this.fetchExperiments(namespacesSelected);\r\n    } else {\r\n      this.setState({ experimentLists: [] });\r\n    }\r\n  };\r\n\r\n  // Invoke the history object to update and URL and start a routing\r\n  goNewExperimentPage = () => {\r\n    history.push('/extensions/iter8/new');\r\n  };\r\n\r\n  goNewExperimentFromFile = () => {\r\n    history.push('/extensions/iter8/newfromfile');\r\n  };\r\n\r\n  // It contains a create new experiment action.\r\n  actionsToolbar = () => {\r\n    return (\r\n      <Dropdown\r\n        id=\"actions\"\r\n        title=\"创建新实验\"\r\n        toggle={<DropdownToggle onToggle={toggle => this.setState({ dropdownOpen: toggle })}>创建新实验</DropdownToggle>}\r\n        onSelect={() => this.setState({ dropdownOpen: !this.state.dropdownOpen })}\r\n        position={DropdownPosition.right}\r\n        isOpen={this.state.dropdownOpen}\r\n        dropdownItems={[\r\n          <DropdownItem\r\n            key=\"createExperiment\"\r\n            isDisabled={!this.state.iter8Info.enabled}\r\n            onClick={() => this.goNewExperimentPage()}\r\n          >\r\n            手动创建新实验\r\n          </DropdownItem>,\r\n          <DropdownItem\r\n            key=\"createExperimentFromFile\"\r\n            isDisabled={!this.state.iter8Info.enabled}\r\n            onClick={() => this.goNewExperimentFromFile()}\r\n          >\r\n            导入配置文件创建新实验\r\n          </DropdownItem>\r\n        ]}\r\n      />\r\n    );\r\n  };\r\n\r\n  onFilterChange = () => {\r\n    // Resetting pagination when filters change\r\n    this.updateListItems();\r\n  };\r\n\r\n  toolbar = () => {\r\n    return (\r\n      <StatefulFilters\r\n        initialFilters={Iter8ExperimentListFilters.availableFilters}\r\n        onFilterChange={this.onFilterChange}\r\n      />\r\n    );\r\n  };\r\n\r\n  getStatusTooltip = (\r\n    phase: string,\r\n    status: string,\r\n    winnerFound: boolean,\r\n    winnerName: string,\r\n    baselineName: string\r\n  ) => {\r\n    let statusValue = '实验状态: 正在进行';\r\n    let retStatus = status;\r\n    if (status.length > 0) {\r\n      const values = status.split(':');\r\n      if (values.length > 1) {\r\n        retStatus = values.slice(1)[0];\r\n      }\r\n      if (status.includes('Failed')) {\r\n        statusValue = '实验状态: 失败';\r\n      } else if (status.includes('Completed')) {\r\n        statusValue = '实验状态: 成功';\r\n        if (winnerName === baselineName) {\r\n          retStatus = '流量切换回基准版本';\r\n        }\r\n      }\r\n    }\r\n    return (\r\n      <TextContent style={{ color: PFColors.White }}>\r\n        <Text>\r\n          <h2>当前阶段: </h2> {phase}\r\n        </Text>\r\n        <Text>\r\n          <h2>{statusValue}</h2> {retStatus}\r\n        </Text>\r\n        <Text>\r\n          <h2>获胜版本: {winnerFound ? winnerName : '未找到'}</h2>\r\n          <Text component={TextVariants.p}>(通过持续部署智能决策实验得到的服务获胜版本)</Text>\r\n        </Text>\r\n      </TextContent>\r\n    );\r\n  };\r\n\r\n  experimentStatusIcon = (key: string, phase: string, winnerStatus: Winner, status: string, baselineName: string) => {\r\n    let className = greenIconStyle;\r\n    let toBaseline = false;\r\n    let statusString = this.getStatusTooltip(\r\n      phase,\r\n      status,\r\n      winnerStatus.winning_version_found,\r\n      winnerStatus.name,\r\n      baselineName\r\n    );\r\n    if (status.includes('Abort')) {\r\n      className = greenIconStyle;\r\n    } else if (!winnerStatus.winning_version_found) {\r\n      className = redIconStyle;\r\n    }\r\n\r\n    if (winnerStatus.name === baselineName) {\r\n      toBaseline = true;\r\n      className = redIconStyle;\r\n    }\r\n    switch (phase) {\r\n      case 'Initializing':\r\n        return (\r\n          <Tooltip\r\n            key={'Initializing_' + key}\r\n            aria-label={'Status indicator'}\r\n            position={PopoverPosition.auto}\r\n            className={'health_indicator'}\r\n            content={<>{statusString}</>}\r\n          >\r\n            <KialiIcon.InProgressIcon className={statusIconStyle} />\r\n          </Tooltip>\r\n        );\r\n      case 'Progressing':\r\n        return (\r\n          <Tooltip\r\n            key={'Progressing_' + key}\r\n            aria-label={'Status indicator'}\r\n            position={PopoverPosition.auto}\r\n            className={'health_indicator'}\r\n            content={<>{statusString}</>}\r\n          >\r\n            <KialiIcon.OnRunningIcon className={statusIconStyle} />\r\n          </Tooltip>\r\n        );\r\n      case 'Pause':\r\n        return (\r\n          <Tooltip\r\n            key={'Pause_' + key}\r\n            aria-label={'Status indicator'}\r\n            position={PopoverPosition.auto}\r\n            className={'health_indicator'}\r\n            content={<>{statusString}</>}\r\n          >\r\n            <KialiIcon.PauseCircle className={statusIconStyle} />\r\n          </Tooltip>\r\n        );\r\n      case 'Completed':\r\n        if (status.includes('Abort')) {\r\n          return (\r\n            <Tooltip\r\n              key={'Completed_' + key}\r\n              aria-label={'Status indicator'}\r\n              position={PopoverPosition.auto}\r\n              className={'health_indicator'}\r\n              content={<>{statusString}</>}\r\n            >\r\n              <PowerOffIcon className={className} />\r\n            </Tooltip>\r\n          );\r\n        } else if (toBaseline) {\r\n          return (\r\n            <Tooltip\r\n              key={'Completed_' + key}\r\n              aria-label={'Status indicator'}\r\n              position={PopoverPosition.auto}\r\n              className={'health_indicator'}\r\n              content={<>{statusString}</>}\r\n            >\r\n              <OkIcon className={className} />\r\n            </Tooltip>\r\n          );\r\n        }\r\n        return (\r\n          <Tooltip\r\n            key={'Completed_' + key}\r\n            aria-label={'Status indicator'}\r\n            position={PopoverPosition.auto}\r\n            className={'health_indicator'}\r\n            content={<>{statusString}</>}\r\n          >\r\n            <OkIcon className={className} />\r\n          </Tooltip>\r\n        );\r\n      default:\r\n        return (\r\n          <Tooltip\r\n            key={'default_' + key}\r\n            aria-label={'Status indicator'}\r\n            position={PopoverPosition.auto}\r\n            className={'health_indicator'}\r\n            content={<>{statusString}</>}\r\n          >\r\n            <KialiIcon.OnRunningIcon className={statusIconStyle} />\r\n          </Tooltip>\r\n        );\r\n    }\r\n  };\r\n\r\n  redirectLink(namespace: string, name: string, kind: string) {\r\n    if (kind === 'Deployment') {\r\n      let linkTo = '/namespaces/' + namespace + '/workloads/' + name;\r\n      return (\r\n        <>\r\n          <PFBadge badge={{ badge: 'W' }} />\r\n          <Link to={linkTo}>{name}</Link>\r\n        </>\r\n      );\r\n    } else {\r\n      if (name !== '') {\r\n        let linkTo = '/namespaces/' + namespace + '/services/' + name;\r\n        return (\r\n          <>\r\n            <PFBadge badge={{ badge: 'S' }} />\r\n            <Link to={linkTo}>{name}</Link>\r\n          </>\r\n        );\r\n      } else {\r\n        return 'N/A';\r\n      }\r\n    }\r\n  }\r\n\r\n  // Helper used to build the table content.\r\n  rows = (): IRow[] => {\r\n    return this.state.experimentLists.map(h => {\r\n      let candidates: string[] = [];\r\n      for (const c of h.candidates) {\r\n        candidates.push(c.name);\r\n      }\r\n\r\n      return {\r\n        cells: [\r\n          <>\r\n            <PFBadge\r\n              key={`TooltipExtensionIter8Name_${h.name}`}\r\n              badge={PFBadges.Iter8}\r\n              position={TooltipPosition.top}\r\n            />\r\n            <PFBadge badge={{ badge: h.experimentKind }} />\r\n            <Link\r\n              to={`/extensions/namespaces/${h.namespace}/iter8/${h.name}?target=${h.targetService}&startTime=${h.startTime}&endTime=${h.endTime}&baseline=${h.baseline.name}&candidates=${candidates}`}\r\n              key={'Experiment_' + h.namespace + '_' + h.namespace}\r\n            >\r\n              {h.name}\r\n            </Link>\r\n          </>,\r\n          <>\r\n            <PFBadge\r\n              key={`TooltipExtensionNamespace_${h.namespace}`}\r\n              badge={PFBadges.Namespace}\r\n              position={TooltipPosition.top}\r\n            />\r\n            {h.namespace}\r\n          </>,\r\n          <>\r\n            {h.kind === 'Deployment'\r\n              ? this.redirectLink(h.namespace, h.targetService, 'Service')\r\n              : this.redirectLink(h.namespace, '', h.kind)}\r\n          </>,\r\n          <>{this.experimentStatusIcon(h.name + '_' + h.namespace, h.phase, h.winner, h.status, h.baseline.name)}</>,\r\n\r\n          <>\r\n            {this.redirectLink(h.namespace, h.baseline.name, h.kind)}\r\n            <br /> {h.baseline.weight}%\r\n          </>,\r\n          <>\r\n            {h.candidates.map(can => {\r\n              return (\r\n                <>\r\n                  {this.redirectLink(h.namespace, can.name, h.kind)}\r\n                  &nbsp;{can.weight}% <br />\r\n                </>\r\n              );\r\n            })}\r\n          </>\r\n        ]\r\n      };\r\n    });\r\n  };\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        <div style={{ backgroundColor: '#fff' }}>\r\n          <DefaultSecondaryMasthead\r\n            rightToolbar={\r\n              <RefreshContainer\r\n                id=\"exp_list_refresh\"\r\n                disabled={false}\r\n                hideLabel={true}\r\n                handleRefresh={this.updateListItems}\r\n                manageURL={true}\r\n              />\r\n            }\r\n            actionsToolbar={this.actionsToolbar()}\r\n          />\r\n        </div>\r\n        <RenderContent>\r\n          <div className={containerPadding}>\r\n            {this.toolbar()}\r\n            <Table\r\n              aria-label=\"Sortable Table\"\r\n              sortBy={this.state.sortBy}\r\n              cells={columns}\r\n              rows={this.rows()}\r\n              onSort={this.onSort}\r\n            >\r\n              <TableHeader />\r\n              {this.state.experimentLists.length > 0 ? (\r\n                <TableBody />\r\n              ) : (\r\n                <tr>\r\n                  <td colSpan={columns.length}>\r\n                    {this.props.activeNamespaces.length > 0 ? (\r\n                      <EmptyState variant={EmptyStateVariant.full}>\r\n                        <Title headingLevel=\"h5\" size=\"lg\">\r\n                          未发现相关实验\r\n                        </Title>\r\n                        <EmptyStateBody>\r\n                          命名空间：\r\n                          {this.props.activeNamespaces.length === 1\r\n                            ? ` ${this.props.activeNamespaces[0].name}`\r\n                            : `s: ${this.props.activeNamespaces.map(ns => ns.name).join(', ')}`} 下尚未创建实验或实验已被删除\r\n                        </EmptyStateBody>\r\n                      </EmptyState>\r\n                    ) : (\r\n                      <EmptyState variant={EmptyStateVariant.full}>\r\n                        <Title headingLevel=\"h5\" size=\"lg\">\r\n                          未选择命名空间\r\n                        </Title>\r\n                        <EmptyStateBody>\r\n                          请先选择命名空间来查看实验\r\n                        </EmptyStateBody>\r\n                      </EmptyState>\r\n                    )}\r\n                  </td>\r\n                </tr>\r\n              )}\r\n            </Table>\r\n          </div>\r\n        </RenderContent>\r\n      </>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state: KialiAppState) => ({\r\n  activeNamespaces: activeNamespacesSelector(state),\r\n  duration: durationSelector(state)\r\n});\r\n\r\nconst Metrics = connect(mapStateToProps)(ExperimentListPageComponent);\r\nexport default Metrics;\r\n"]},"metadata":{},"sourceType":"module"}