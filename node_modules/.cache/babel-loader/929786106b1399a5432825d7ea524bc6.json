{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _excluded = [\"component\", \"componentProps\", \"interval\", \"duration\", \"delay\", \"type\", \"animConfig\", \"ease\", \"leaveReverse\", \"forcedReplay\", \"animatingClassName\", \"onEnd\", \"appear\"];\nimport { useRef, useMemo, useLayoutEffect, useEffect, useState, createElement, cloneElement, forwardRef } from 'react';\nimport { findDOMNode } from 'react-dom';\nimport TweenOne, { Ticker } from 'tween-one';\nimport { toArrayChildren, findChildInChildrenByKey, windowIsUndefined, mergeChildren, transformArguments } from './utils';\nimport AnimTypes from './animTypes';\n\nvar noop = function noop() {};\n\nexport default /*#__PURE__*/forwardRef(function (props, ref) {\n  var _props$component = props.component,\n      component = _props$component === void 0 ? 'div' : _props$component,\n      _props$componentProps = props.componentProps,\n      componentProps = _props$componentProps === void 0 ? {} : _props$componentProps,\n      _props$interval = props.interval,\n      interval = _props$interval === void 0 ? 100 : _props$interval,\n      _props$duration = props.duration,\n      duration = _props$duration === void 0 ? 450 : _props$duration,\n      _props$delay = props.delay,\n      delay = _props$delay === void 0 ? 0 : _props$delay,\n      _props$type = props.type,\n      type = _props$type === void 0 ? 'right' : _props$type,\n      _props$animConfig = props.animConfig,\n      animConfig = _props$animConfig === void 0 ? null : _props$animConfig,\n      _props$ease = props.ease,\n      ease = _props$ease === void 0 ? 'easeOutQuart' : _props$ease,\n      _props$leaveReverse = props.leaveReverse,\n      leaveReverse = _props$leaveReverse === void 0 ? false : _props$leaveReverse,\n      _props$forcedReplay = props.forcedReplay,\n      forcedReplay = _props$forcedReplay === void 0 ? false : _props$forcedReplay,\n      _props$animatingClass = props.animatingClassName,\n      animatingClassName = _props$animatingClass === void 0 ? ['queue-anim-entering', 'queue-anim-leaving'] : _props$animatingClass,\n      _props$onEnd = props.onEnd,\n      onEnd = _props$onEnd === void 0 ? noop : _props$onEnd,\n      _props$appear = props.appear,\n      appear = _props$appear === void 0 ? true : _props$appear,\n      tagProps = _objectWithoutProperties(props, _excluded);\n  /**\n   * @param childrenShow;\n   * 记录 animation 里是否需要 startAnim;\n   * 当前元素是否处在显示状态\n   * enterBegin 到 leaveComplete 之前都处于显示状态\n   */\n\n\n  var childrenShow = useRef({});\n  /**\n   * @param keysToEnter;\n   * 记录进场的 key;\n   */\n\n  var keysToEnter = useRef([]);\n  var recordKeysToEnter = useRef([]);\n  /**\n   * @param keysToLeave;\n   * 记录出场的 key;\n   */\n\n  var keysToLeave = useRef([]);\n  var recordKeysToLeave = useRef([]);\n  /**\n   * @param placeholderTimeoutIds;\n   * 进场时 deley 的 timeout 记录;\n   */\n\n  var placeholderTimeoutIds = useRef({});\n  /**\n   * @param childRefs;\n   * 储存 children 的 ref;\n   */\n\n  var childRefs = useRef({});\n  /**\n   * @param recordAnimKeys;\n   * 记录启动动画 key\n   */\n\n  var recordAnimKeys = useRef({});\n  /**\n   * @param recordAnimKeys;\n   * 记录启动动画 key\n   */\n\n  var recordTweenKeys = useRef({});\n  /**\n   * @param oneEnterBool\n   * 记录第一次进入\n   */\n\n  var oneEnterBool = useRef(false);\n  var originalChildren = useRef([]);\n\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      child = _useState2[0],\n      setChild = _useState2[1];\n\n  var _useState3 = useState({}),\n      _useState4 = _slicedToArray(_useState3, 2),\n      childShow = _useState4[0],\n      setChildShow = _useState4[1];\n\n  var getTweenSingleConfig = function getTweenSingleConfig(data, num, enterOrLeave) {\n    var obj = {};\n    Object.keys(data).forEach(function (key) {\n      if (Array.isArray(data[key])) {\n        obj[key] = data[key][num];\n      } else if (!enterOrLeave && !num || enterOrLeave && num) {\n        obj[key] = data[key];\n      }\n    });\n    return obj;\n  };\n\n  var getTweenAnimConfig = function getTweenAnimConfig(data, num, enterOrLeave) {\n    if (Array.isArray(data)) {\n      return data.map(function (item) {\n        return getTweenSingleConfig(item, num, enterOrLeave);\n      });\n    }\n\n    return getTweenSingleConfig(data, num, enterOrLeave);\n  };\n\n  var getTweenType = function getTweenType($type, num) {\n    var data = AnimTypes[$type];\n    return getTweenAnimConfig(data, num);\n  };\n\n  var getAnimData = function getAnimData(key, i, enterOrLeave, startOrEnd) {\n    return (\n      /**\n       * transformArguments 第一个为 enter, 第二个为 leave；\n       * getTweenAnimConfig or getTweenType 第一个为到达的位置， 第二个为开始的位置。\n       * 用 tween-one 的数组来实现老的动画逻辑。。。\n       */\n      animConfig ? getTweenAnimConfig(transformArguments(animConfig, key, i)[enterOrLeave], startOrEnd, enterOrLeave) : getTweenType(transformArguments(type, key, i)[enterOrLeave], startOrEnd)\n    );\n  };\n\n  var getTweenData = function getTweenData(key, i, $type) {\n    var enterOrLeave = $type === 'enter' ? 0 : 1;\n    var start = $type === 'enter' ? 1 : 0;\n    var end = $type === 'enter' ? 0 : 1;\n    var animate = getAnimData(key, i, enterOrLeave, end);\n    var startAnim = $type === 'enter' && (forcedReplay || !childrenShow.current[key]) ? getAnimData(key, i, enterOrLeave, start) : null;\n    var $ease = transformArguments(ease, key, i)[enterOrLeave];\n    var $duration = transformArguments(duration, key, i)[enterOrLeave];\n\n    if (Array.isArray(ease) && (ease.length > 2 || Array.isArray(ease[0]))) {\n      $ease = $ease.map(function (num) {\n        return num * 100;\n      });\n      $ease = \"M0,100C\".concat($ease[0], \",\").concat(100 - $ease[1], \",\").concat($ease[2], \",\").concat(100 - $ease[3], \",100,0\");\n    }\n\n    return {\n      startAnim: startAnim,\n      animate: animate,\n      ease: $ease,\n      duration: $duration\n    };\n  };\n\n  var enterBegin = function enterBegin(key, e) {\n    var elem = e.targets;\n    elem.className = elem.className.replace(animatingClassName[1], '');\n\n    if (elem.className.indexOf(animatingClassName[0]) === -1) {\n      elem.className = \"\".concat(elem.className, \" \").concat(animatingClassName[0]).trim();\n    }\n\n    if (keysToEnter.current.indexOf(key) >= 0) {\n      keysToEnter.current.splice(keysToEnter.current.indexOf(key), 1);\n    }\n\n    childrenShow.current[key] = true;\n  };\n\n  var enterComplete = function enterComplete(key, e) {\n    if (keysToLeave.current.indexOf(key) >= 0) {\n      return;\n    }\n\n    var elem = e.targets;\n    elem.className = elem.className.replace(animatingClassName[0], '').trim();\n    delete recordTweenKeys.current[key];\n    onEnd({\n      key: key,\n      type: 'enter',\n      target: elem\n    });\n  };\n\n  var leaveBegin = function leaveBegin(key, e) {\n    var elem = e.targets;\n    elem.className = elem.className.replace(animatingClassName[0], '');\n\n    if (elem.className.indexOf(animatingClassName[1]) === -1) {\n      elem.className = \"\".concat(elem.className, \" \").concat(animatingClassName[1]).trim();\n    }\n  };\n\n  var leaveComplete = function leaveComplete(key, e) {\n    // 切换时同时触发 onComplete。 手动跳出。。。\n    toArrayChildren(props.children).findIndex(function (c) {\n      return c && c.key === key;\n    });\n\n    if (toArrayChildren(props.children).findIndex(function (c) {\n      return c && c.key === key;\n    }) >= 0) {\n      return;\n    }\n\n    delete childrenShow.current[key];\n    delete recordTweenKeys.current[key];\n    originalChildren.current = originalChildren.current.filter(function (c) {\n      return c.key !== key;\n    }); // 这里不用启动动画，，直接删；\n\n    if (keysToLeave.current.indexOf(key) >= 0) {\n      keysToLeave.current.splice(keysToLeave.current.indexOf(key), 1);\n    }\n\n    var needLeave = keysToLeave.current.some(function (c) {\n      return childShow[c];\n    });\n\n    if (!needLeave) {\n      var currentChildren = toArrayChildren(props.children);\n      setChild(currentChildren);\n      setChildShow(_objectSpread({}, childrenShow.current));\n      recordKeysToLeave.current.forEach(function (k) {\n        delete recordAnimKeys.current[k];\n      });\n    }\n\n    var elem = e.targets;\n    elem.className = elem.className.replace(animatingClassName[1], '').trim();\n    onEnd({\n      key: key,\n      type: 'leave',\n      target: elem\n    });\n  };\n\n  var performEnterBegin = function performEnterBegin(key) {\n    childShow[key] = true;\n    Ticker.clear(placeholderTimeoutIds.current[key]);\n    delete placeholderTimeoutIds.current[key];\n    setChildShow(_objectSpread({}, childShow));\n  };\n\n  var performEnter = function performEnter(key, i) {\n    var $interval = transformArguments(interval, key, i)[0];\n    var $delay = transformArguments(delay, key, i)[0];\n    placeholderTimeoutIds.current[key] = Ticker.timeout(function () {\n      performEnterBegin(key);\n    }, $interval * i + $delay);\n  };\n\n  var performLeave = function performLeave(key) {\n    Ticker.clear(placeholderTimeoutIds.current[key]);\n    delete placeholderTimeoutIds.current[key];\n  };\n\n  var getTweenOneEnterOrLeave = function getTweenOneEnterOrLeave(key, i, $delay, $type) {\n    var animateData = getTweenData(key, i, $type);\n\n    var onStart = function onStart(e) {\n      ($type === 'enter' ? enterBegin : leaveBegin)(key, e);\n    };\n\n    var onComplete = function onComplete(e) {\n      ($type === 'enter' ? enterComplete : leaveComplete)(key, e);\n    };\n\n    if (Array.isArray(animateData.animate)) {\n      var length = animateData.animate.length - 1;\n      var animation = animateData.animate.map(function (item, ii) {\n        return _objectSpread(_objectSpread({}, item), {}, {\n          startAt: animateData.startAnim ? animateData.startAnim[ii] : undefined,\n          duration: animateData.duration / length,\n          delay: !ii && $type === 'leave' ? $delay : 0,\n          onStart: !ii ? onStart : undefined,\n          onComplete: ii === length ? onComplete : undefined\n        });\n      });\n      return animation;\n    }\n\n    return _objectSpread(_objectSpread({}, animateData.animate), {}, {\n      startAt: animateData.startAnim || undefined,\n      ease: animateData.ease,\n      duration: animateData.duration,\n      onStart: onStart,\n      onComplete: onComplete,\n      delay: $delay\n    });\n  };\n\n  useEffect(function () {\n    return function () {\n      Object.keys(recordTweenKeys.current).forEach(function (key) {\n        var tween = recordTweenKeys.current[key];\n\n        if (!tween) {\n          return;\n        }\n\n        tween.kill();\n      });\n    };\n  }, []);\n  useEffect(function () {\n    var nextChildren = toArrayChildren(props.children).filter(function (c) {\n      return c;\n    });\n    var currentChildren = originalChildren.current.filter(function (item) {\n      return item;\n    });\n    var newChildren = mergeChildren(currentChildren, nextChildren);\n    var $keysToEnter = [];\n    var $keysToLeave = [];\n\n    if (!appear && !oneEnterBool.current) {\n      var $childShow = {};\n      newChildren.forEach(function (c) {\n        if (!c || !c.key) {\n          return;\n        }\n\n        $childShow[c.key] = true;\n      });\n      originalChildren.current = newChildren;\n      childrenShow.current = _objectSpread({}, $childShow);\n      setChildShow($childShow);\n    } else {\n      // console.log(nextChildren, recordAnimKeys.current, keysToEnter.current, keysToLeave.current);\n      currentChildren.forEach(function (c) {\n        if (!c) {\n          return;\n        }\n\n        var key = c.key;\n        var hasNext = findChildInChildrenByKey(nextChildren, key);\n\n        if (!hasNext && key) {\n          $keysToLeave.push(key);\n          Ticker.clear(placeholderTimeoutIds.current[key]);\n          delete placeholderTimeoutIds.current[key];\n        }\n      });\n      nextChildren.forEach(function (c) {\n        if (!c) {\n          return;\n        }\n\n        var key = c.key;\n        var hasPrev = findChildInChildrenByKey(currentChildren, key); // 如果 nextChildren 和当前的一致，且动画里是出场，改回进场；\n\n        if (!hasPrev && key || (!recordAnimKeys.current[key] || recordAnimKeys.current[key] === 'leave' || keysToEnter.current.indexOf(key) >= 0) && $keysToLeave.indexOf(key) === -1) {\n          $keysToEnter.push(key);\n        }\n      });\n    } // console.log('child update', $keysToEnter, $keysToLeave, newChildren);\n\n\n    keysToEnter.current = $keysToEnter; // keysToEnter 在启动时就会删除；\n\n    recordKeysToEnter.current = [].concat($keysToEnter);\n    keysToLeave.current = $keysToLeave;\n    recordKeysToLeave.current = [].concat($keysToLeave); // console.log($keysToEnter, $keysToLeave);\n\n    setChild(newChildren);\n  }, [props.children]);\n  useLayoutEffect(function () {\n    originalChildren.current = child || [];\n\n    if (appear || oneEnterBool.current) {\n      var $keysToEnter = _toConsumableArray(keysToEnter.current);\n\n      var $keysToLeave = _toConsumableArray(keysToLeave.current);\n\n      $keysToEnter.forEach(performEnter);\n      $keysToLeave.forEach(performLeave);\n    }\n\n    if (child) {\n      oneEnterBool.current = true;\n    }\n  }, [child]);\n  useLayoutEffect(function () {\n    if (child) {\n      child.forEach(function (item) {\n        var key = item.key;\n        var dom = childRefs.current[key];\n\n        if (!dom) {\n          return;\n        }\n\n        var animation;\n        var index = keysToLeave.current.indexOf(key); // children.findIndex(c => c.key === key);\n\n        var $interval = transformArguments(interval, key, index);\n        var $delay = transformArguments(delay, key, index); // 处理出场\n\n        if (index >= 0) {\n          if (recordAnimKeys.current[key] === 'leave') {\n            return;\n          }\n\n          var order = leaveReverse ? keysToLeave.current.length - index - 1 : index;\n          var d = $interval[1] * order + $delay[1];\n          animation = getTweenOneEnterOrLeave(key, index, d, 'leave');\n          recordAnimKeys.current[key] = 'leave';\n        } else {\n          if (recordAnimKeys.current[key] === 'enter' || keysToEnter.current.indexOf(key) === -1) {\n            return;\n          }\n\n          index = recordKeysToEnter.current.indexOf(key);\n\n          var _d = $interval[0] * index + $delay[0]; // console.log(recordAnimKeys.current[key], dom);\n\n\n          animation = getTweenOneEnterOrLeave(key, index, recordAnimKeys.current[key] === 'leave' ? _d : 0, 'enter');\n          recordAnimKeys.current[key] = 'enter';\n        }\n\n        if (recordTweenKeys.current[key]) {\n          recordTweenKeys.current[key].kill();\n        }\n\n        if (forcedReplay) {\n          var anim = _objectSpread(_objectSpread({}, Array.isArray(animation) ? animation[0].startAt : animation.startAt), {}, {\n            type: 'set'\n          });\n\n          TweenOne(dom, {\n            animation: anim\n          });\n        }\n\n        recordTweenKeys.current[key] = TweenOne(dom, {\n          animation: animation\n        });\n      });\n    }\n  }, [childShow, child]);\n  return useMemo(function () {\n    // console.log('--------render--------', childShow);\n    if (windowIsUndefined) {\n      return /*#__PURE__*/createElement(component, _objectSpread(_objectSpread(_objectSpread({}, tagProps), componentProps), {}, {\n        ref: ref\n      }));\n    }\n\n    var childrenToRender = toArrayChildren(child).map(function (item) {\n      if (!item || !item.key) {\n        return item;\n      }\n\n      return childShow[item.key] && /*#__PURE__*/cloneElement(item, {\n        ref: function ref(c) {\n          childRefs.current[item.key] = c instanceof Element ? c : findDOMNode(c);\n\n          if (!c) {\n            delete childRefs.current[item.key];\n          }\n        },\n        key: item.key\n      });\n    });\n\n    var p = _objectSpread(_objectSpread(_objectSpread({}, tagProps), componentProps), {}, {\n      ref: ref\n    });\n\n    return /*#__PURE__*/createElement(component, p, childrenToRender);\n  }, [childShow, child]);\n});","map":{"version":3,"sources":["/root/GraduateProject/node_modules/rc-queue-anim/es/QueueAnim.js"],"names":["_toConsumableArray","_objectSpread","_slicedToArray","_objectWithoutProperties","_excluded","useRef","useMemo","useLayoutEffect","useEffect","useState","createElement","cloneElement","forwardRef","findDOMNode","TweenOne","Ticker","toArrayChildren","findChildInChildrenByKey","windowIsUndefined","mergeChildren","transformArguments","AnimTypes","noop","props","ref","_props$component","component","_props$componentProps","componentProps","_props$interval","interval","_props$duration","duration","_props$delay","delay","_props$type","type","_props$animConfig","animConfig","_props$ease","ease","_props$leaveReverse","leaveReverse","_props$forcedReplay","forcedReplay","_props$animatingClass","animatingClassName","_props$onEnd","onEnd","_props$appear","appear","tagProps","childrenShow","keysToEnter","recordKeysToEnter","keysToLeave","recordKeysToLeave","placeholderTimeoutIds","childRefs","recordAnimKeys","recordTweenKeys","oneEnterBool","originalChildren","_useState","_useState2","child","setChild","_useState3","_useState4","childShow","setChildShow","getTweenSingleConfig","data","num","enterOrLeave","obj","Object","keys","forEach","key","Array","isArray","getTweenAnimConfig","map","item","getTweenType","$type","getAnimData","i","startOrEnd","getTweenData","start","end","animate","startAnim","current","$ease","$duration","length","concat","enterBegin","e","elem","targets","className","replace","indexOf","trim","splice","enterComplete","target","leaveBegin","leaveComplete","children","findIndex","c","filter","needLeave","some","currentChildren","k","performEnterBegin","clear","performEnter","$interval","$delay","timeout","performLeave","getTweenOneEnterOrLeave","animateData","onStart","onComplete","animation","ii","startAt","undefined","tween","kill","nextChildren","newChildren","$keysToEnter","$keysToLeave","$childShow","hasNext","push","hasPrev","dom","index","order","d","_d","anim","childrenToRender","Element","p"],"mappings":"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","sourcesContent":["import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _excluded = [\"component\", \"componentProps\", \"interval\", \"duration\", \"delay\", \"type\", \"animConfig\", \"ease\", \"leaveReverse\", \"forcedReplay\", \"animatingClassName\", \"onEnd\", \"appear\"];\nimport { useRef, useMemo, useLayoutEffect, useEffect, useState, createElement, cloneElement, forwardRef } from 'react';\nimport { findDOMNode } from 'react-dom';\nimport TweenOne, { Ticker } from 'tween-one';\nimport { toArrayChildren, findChildInChildrenByKey, windowIsUndefined, mergeChildren, transformArguments } from './utils';\nimport AnimTypes from './animTypes';\n\nvar noop = function noop() {};\n\nexport default /*#__PURE__*/forwardRef(function (props, ref) {\n  var _props$component = props.component,\n      component = _props$component === void 0 ? 'div' : _props$component,\n      _props$componentProps = props.componentProps,\n      componentProps = _props$componentProps === void 0 ? {} : _props$componentProps,\n      _props$interval = props.interval,\n      interval = _props$interval === void 0 ? 100 : _props$interval,\n      _props$duration = props.duration,\n      duration = _props$duration === void 0 ? 450 : _props$duration,\n      _props$delay = props.delay,\n      delay = _props$delay === void 0 ? 0 : _props$delay,\n      _props$type = props.type,\n      type = _props$type === void 0 ? 'right' : _props$type,\n      _props$animConfig = props.animConfig,\n      animConfig = _props$animConfig === void 0 ? null : _props$animConfig,\n      _props$ease = props.ease,\n      ease = _props$ease === void 0 ? 'easeOutQuart' : _props$ease,\n      _props$leaveReverse = props.leaveReverse,\n      leaveReverse = _props$leaveReverse === void 0 ? false : _props$leaveReverse,\n      _props$forcedReplay = props.forcedReplay,\n      forcedReplay = _props$forcedReplay === void 0 ? false : _props$forcedReplay,\n      _props$animatingClass = props.animatingClassName,\n      animatingClassName = _props$animatingClass === void 0 ? ['queue-anim-entering', 'queue-anim-leaving'] : _props$animatingClass,\n      _props$onEnd = props.onEnd,\n      onEnd = _props$onEnd === void 0 ? noop : _props$onEnd,\n      _props$appear = props.appear,\n      appear = _props$appear === void 0 ? true : _props$appear,\n      tagProps = _objectWithoutProperties(props, _excluded);\n  /**\n   * @param childrenShow;\n   * 记录 animation 里是否需要 startAnim;\n   * 当前元素是否处在显示状态\n   * enterBegin 到 leaveComplete 之前都处于显示状态\n   */\n\n\n  var childrenShow = useRef({});\n  /**\n   * @param keysToEnter;\n   * 记录进场的 key;\n   */\n\n  var keysToEnter = useRef([]);\n  var recordKeysToEnter = useRef([]);\n  /**\n   * @param keysToLeave;\n   * 记录出场的 key;\n   */\n\n  var keysToLeave = useRef([]);\n  var recordKeysToLeave = useRef([]);\n  /**\n   * @param placeholderTimeoutIds;\n   * 进场时 deley 的 timeout 记录;\n   */\n\n  var placeholderTimeoutIds = useRef({});\n  /**\n   * @param childRefs;\n   * 储存 children 的 ref;\n   */\n\n  var childRefs = useRef({});\n  /**\n   * @param recordAnimKeys;\n   * 记录启动动画 key\n   */\n\n  var recordAnimKeys = useRef({});\n  /**\n   * @param recordAnimKeys;\n   * 记录启动动画 key\n   */\n\n  var recordTweenKeys = useRef({});\n  /**\n   * @param oneEnterBool\n   * 记录第一次进入\n   */\n\n  var oneEnterBool = useRef(false);\n  var originalChildren = useRef([]);\n\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      child = _useState2[0],\n      setChild = _useState2[1];\n\n  var _useState3 = useState({}),\n      _useState4 = _slicedToArray(_useState3, 2),\n      childShow = _useState4[0],\n      setChildShow = _useState4[1];\n\n  var getTweenSingleConfig = function getTweenSingleConfig(data, num, enterOrLeave) {\n    var obj = {};\n    Object.keys(data).forEach(function (key) {\n      if (Array.isArray(data[key])) {\n        obj[key] = data[key][num];\n      } else if (!enterOrLeave && !num || enterOrLeave && num) {\n        obj[key] = data[key];\n      }\n    });\n    return obj;\n  };\n\n  var getTweenAnimConfig = function getTweenAnimConfig(data, num, enterOrLeave) {\n    if (Array.isArray(data)) {\n      return data.map(function (item) {\n        return getTweenSingleConfig(item, num, enterOrLeave);\n      });\n    }\n\n    return getTweenSingleConfig(data, num, enterOrLeave);\n  };\n\n  var getTweenType = function getTweenType($type, num) {\n    var data = AnimTypes[$type];\n    return getTweenAnimConfig(data, num);\n  };\n\n  var getAnimData = function getAnimData(key, i, enterOrLeave, startOrEnd) {\n    return (\n      /**\n       * transformArguments 第一个为 enter, 第二个为 leave；\n       * getTweenAnimConfig or getTweenType 第一个为到达的位置， 第二个为开始的位置。\n       * 用 tween-one 的数组来实现老的动画逻辑。。。\n       */\n      animConfig ? getTweenAnimConfig(transformArguments(animConfig, key, i)[enterOrLeave], startOrEnd, enterOrLeave) : getTweenType(transformArguments(type, key, i)[enterOrLeave], startOrEnd)\n    );\n  };\n\n  var getTweenData = function getTweenData(key, i, $type) {\n    var enterOrLeave = $type === 'enter' ? 0 : 1;\n    var start = $type === 'enter' ? 1 : 0;\n    var end = $type === 'enter' ? 0 : 1;\n    var animate = getAnimData(key, i, enterOrLeave, end);\n    var startAnim = $type === 'enter' && (forcedReplay || !childrenShow.current[key]) ? getAnimData(key, i, enterOrLeave, start) : null;\n    var $ease = transformArguments(ease, key, i)[enterOrLeave];\n    var $duration = transformArguments(duration, key, i)[enterOrLeave];\n\n    if (Array.isArray(ease) && (ease.length > 2 || Array.isArray(ease[0]))) {\n      $ease = $ease.map(function (num) {\n        return num * 100;\n      });\n      $ease = \"M0,100C\".concat($ease[0], \",\").concat(100 - $ease[1], \",\").concat($ease[2], \",\").concat(100 - $ease[3], \",100,0\");\n    }\n\n    return {\n      startAnim: startAnim,\n      animate: animate,\n      ease: $ease,\n      duration: $duration\n    };\n  };\n\n  var enterBegin = function enterBegin(key, e) {\n    var elem = e.targets;\n    elem.className = elem.className.replace(animatingClassName[1], '');\n\n    if (elem.className.indexOf(animatingClassName[0]) === -1) {\n      elem.className = \"\".concat(elem.className, \" \").concat(animatingClassName[0]).trim();\n    }\n\n    if (keysToEnter.current.indexOf(key) >= 0) {\n      keysToEnter.current.splice(keysToEnter.current.indexOf(key), 1);\n    }\n\n    childrenShow.current[key] = true;\n  };\n\n  var enterComplete = function enterComplete(key, e) {\n    if (keysToLeave.current.indexOf(key) >= 0) {\n      return;\n    }\n\n    var elem = e.targets;\n    elem.className = elem.className.replace(animatingClassName[0], '').trim();\n    delete recordTweenKeys.current[key];\n    onEnd({\n      key: key,\n      type: 'enter',\n      target: elem\n    });\n  };\n\n  var leaveBegin = function leaveBegin(key, e) {\n    var elem = e.targets;\n    elem.className = elem.className.replace(animatingClassName[0], '');\n\n    if (elem.className.indexOf(animatingClassName[1]) === -1) {\n      elem.className = \"\".concat(elem.className, \" \").concat(animatingClassName[1]).trim();\n    }\n  };\n\n  var leaveComplete = function leaveComplete(key, e) {\n    // 切换时同时触发 onComplete。 手动跳出。。。\n    toArrayChildren(props.children).findIndex(function (c) {\n      return c && c.key === key;\n    });\n\n    if (toArrayChildren(props.children).findIndex(function (c) {\n      return c && c.key === key;\n    }) >= 0) {\n      return;\n    }\n\n    delete childrenShow.current[key];\n    delete recordTweenKeys.current[key];\n    originalChildren.current = originalChildren.current.filter(function (c) {\n      return c.key !== key;\n    }); // 这里不用启动动画，，直接删；\n\n    if (keysToLeave.current.indexOf(key) >= 0) {\n      keysToLeave.current.splice(keysToLeave.current.indexOf(key), 1);\n    }\n\n    var needLeave = keysToLeave.current.some(function (c) {\n      return childShow[c];\n    });\n\n    if (!needLeave) {\n      var currentChildren = toArrayChildren(props.children);\n      setChild(currentChildren);\n      setChildShow(_objectSpread({}, childrenShow.current));\n      recordKeysToLeave.current.forEach(function (k) {\n        delete recordAnimKeys.current[k];\n      });\n    }\n\n    var elem = e.targets;\n    elem.className = elem.className.replace(animatingClassName[1], '').trim();\n    onEnd({\n      key: key,\n      type: 'leave',\n      target: elem\n    });\n  };\n\n  var performEnterBegin = function performEnterBegin(key) {\n    childShow[key] = true;\n    Ticker.clear(placeholderTimeoutIds.current[key]);\n    delete placeholderTimeoutIds.current[key];\n    setChildShow(_objectSpread({}, childShow));\n  };\n\n  var performEnter = function performEnter(key, i) {\n    var $interval = transformArguments(interval, key, i)[0];\n    var $delay = transformArguments(delay, key, i)[0];\n    placeholderTimeoutIds.current[key] = Ticker.timeout(function () {\n      performEnterBegin(key);\n    }, $interval * i + $delay);\n  };\n\n  var performLeave = function performLeave(key) {\n    Ticker.clear(placeholderTimeoutIds.current[key]);\n    delete placeholderTimeoutIds.current[key];\n  };\n\n  var getTweenOneEnterOrLeave = function getTweenOneEnterOrLeave(key, i, $delay, $type) {\n    var animateData = getTweenData(key, i, $type);\n\n    var onStart = function onStart(e) {\n      ($type === 'enter' ? enterBegin : leaveBegin)(key, e);\n    };\n\n    var onComplete = function onComplete(e) {\n      ($type === 'enter' ? enterComplete : leaveComplete)(key, e);\n    };\n\n    if (Array.isArray(animateData.animate)) {\n      var length = animateData.animate.length - 1;\n      var animation = animateData.animate.map(function (item, ii) {\n        return _objectSpread(_objectSpread({}, item), {}, {\n          startAt: animateData.startAnim ? animateData.startAnim[ii] : undefined,\n          duration: animateData.duration / length,\n          delay: !ii && $type === 'leave' ? $delay : 0,\n          onStart: !ii ? onStart : undefined,\n          onComplete: ii === length ? onComplete : undefined\n        });\n      });\n      return animation;\n    }\n\n    return _objectSpread(_objectSpread({}, animateData.animate), {}, {\n      startAt: animateData.startAnim || undefined,\n      ease: animateData.ease,\n      duration: animateData.duration,\n      onStart: onStart,\n      onComplete: onComplete,\n      delay: $delay\n    });\n  };\n\n  useEffect(function () {\n    return function () {\n      Object.keys(recordTweenKeys.current).forEach(function (key) {\n        var tween = recordTweenKeys.current[key];\n\n        if (!tween) {\n          return;\n        }\n\n        tween.kill();\n      });\n    };\n  }, []);\n  useEffect(function () {\n    var nextChildren = toArrayChildren(props.children).filter(function (c) {\n      return c;\n    });\n    var currentChildren = originalChildren.current.filter(function (item) {\n      return item;\n    });\n    var newChildren = mergeChildren(currentChildren, nextChildren);\n    var $keysToEnter = [];\n    var $keysToLeave = [];\n\n    if (!appear && !oneEnterBool.current) {\n      var $childShow = {};\n      newChildren.forEach(function (c) {\n        if (!c || !c.key) {\n          return;\n        }\n\n        $childShow[c.key] = true;\n      });\n      originalChildren.current = newChildren;\n      childrenShow.current = _objectSpread({}, $childShow);\n      setChildShow($childShow);\n    } else {\n      // console.log(nextChildren, recordAnimKeys.current, keysToEnter.current, keysToLeave.current);\n      currentChildren.forEach(function (c) {\n        if (!c) {\n          return;\n        }\n\n        var key = c.key;\n        var hasNext = findChildInChildrenByKey(nextChildren, key);\n\n        if (!hasNext && key) {\n          $keysToLeave.push(key);\n          Ticker.clear(placeholderTimeoutIds.current[key]);\n          delete placeholderTimeoutIds.current[key];\n        }\n      });\n      nextChildren.forEach(function (c) {\n        if (!c) {\n          return;\n        }\n\n        var key = c.key;\n        var hasPrev = findChildInChildrenByKey(currentChildren, key); // 如果 nextChildren 和当前的一致，且动画里是出场，改回进场；\n\n        if (!hasPrev && key || (!recordAnimKeys.current[key] || recordAnimKeys.current[key] === 'leave' || keysToEnter.current.indexOf(key) >= 0) && $keysToLeave.indexOf(key) === -1) {\n          $keysToEnter.push(key);\n        }\n      });\n    } // console.log('child update', $keysToEnter, $keysToLeave, newChildren);\n\n\n    keysToEnter.current = $keysToEnter; // keysToEnter 在启动时就会删除；\n\n    recordKeysToEnter.current = [].concat($keysToEnter);\n    keysToLeave.current = $keysToLeave;\n    recordKeysToLeave.current = [].concat($keysToLeave); // console.log($keysToEnter, $keysToLeave);\n\n    setChild(newChildren);\n  }, [props.children]);\n  useLayoutEffect(function () {\n    originalChildren.current = child || [];\n\n    if (appear || oneEnterBool.current) {\n      var $keysToEnter = _toConsumableArray(keysToEnter.current);\n\n      var $keysToLeave = _toConsumableArray(keysToLeave.current);\n\n      $keysToEnter.forEach(performEnter);\n      $keysToLeave.forEach(performLeave);\n    }\n\n    if (child) {\n      oneEnterBool.current = true;\n    }\n  }, [child]);\n  useLayoutEffect(function () {\n    if (child) {\n      child.forEach(function (item) {\n        var key = item.key;\n        var dom = childRefs.current[key];\n\n        if (!dom) {\n          return;\n        }\n\n        var animation;\n        var index = keysToLeave.current.indexOf(key); // children.findIndex(c => c.key === key);\n\n        var $interval = transformArguments(interval, key, index);\n        var $delay = transformArguments(delay, key, index); // 处理出场\n\n        if (index >= 0) {\n          if (recordAnimKeys.current[key] === 'leave') {\n            return;\n          }\n\n          var order = leaveReverse ? keysToLeave.current.length - index - 1 : index;\n          var d = $interval[1] * order + $delay[1];\n          animation = getTweenOneEnterOrLeave(key, index, d, 'leave');\n          recordAnimKeys.current[key] = 'leave';\n        } else {\n          if (recordAnimKeys.current[key] === 'enter' || keysToEnter.current.indexOf(key) === -1) {\n            return;\n          }\n\n          index = recordKeysToEnter.current.indexOf(key);\n\n          var _d = $interval[0] * index + $delay[0]; // console.log(recordAnimKeys.current[key], dom);\n\n\n          animation = getTweenOneEnterOrLeave(key, index, recordAnimKeys.current[key] === 'leave' ? _d : 0, 'enter');\n          recordAnimKeys.current[key] = 'enter';\n        }\n\n        if (recordTweenKeys.current[key]) {\n          recordTweenKeys.current[key].kill();\n        }\n\n        if (forcedReplay) {\n          var anim = _objectSpread(_objectSpread({}, Array.isArray(animation) ? animation[0].startAt : animation.startAt), {}, {\n            type: 'set'\n          });\n\n          TweenOne(dom, {\n            animation: anim\n          });\n        }\n\n        recordTweenKeys.current[key] = TweenOne(dom, {\n          animation: animation\n        });\n      });\n    }\n  }, [childShow, child]);\n  return useMemo(function () {\n    // console.log('--------render--------', childShow);\n    if (windowIsUndefined) {\n      return /*#__PURE__*/createElement(component, _objectSpread(_objectSpread(_objectSpread({}, tagProps), componentProps), {}, {\n        ref: ref\n      }));\n    }\n\n    var childrenToRender = toArrayChildren(child).map(function (item) {\n      if (!item || !item.key) {\n        return item;\n      }\n\n      return childShow[item.key] && /*#__PURE__*/cloneElement(item, {\n        ref: function ref(c) {\n          childRefs.current[item.key] = c instanceof Element ? c : findDOMNode(c);\n\n          if (!c) {\n            delete childRefs.current[item.key];\n          }\n        },\n        key: item.key\n      });\n    });\n\n    var p = _objectSpread(_objectSpread(_objectSpread({}, tagProps), componentProps), {}, {\n      ref: ref\n    });\n\n    return /*#__PURE__*/createElement(component, p, childrenToRender);\n  }, [childShow, child]);\n});"]},"metadata":{},"sourceType":"module"}